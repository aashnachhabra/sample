we are refactoring the clone year/state/product functionality in above jsp snippet now the modal will look like below it will have 3 fields for each coc , state and product family and only one to from is mandatory not all.
cases
1) if only one of the to from is populated all the fields corresponding to it should be cloned to the from firlef. for eg if coc series "from" field is 2025 and "to" field is 2026 then irrespective of product family and state all 2025 data should be cloned to 2026 data and same logic for all fields
2) if 2 are selected 
3) if all are given then specific cloning

no backend changes required since the payload remains same only how we pick the elements from ui changes
rest all logic stays unchanged
also attaching js file to understand clone better

coc should be dropdown like existing coc in above pr , all fields of clone are single select in modal and clone year/state/product should always be enabled now not disable enabled conditionally except role
exisitng jsp -

<%@ page import="com.optum.ideate.mongodb.domain.BenefitCategory" %> <%@ page import="java.util.List" %> <%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %> <%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %> <%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %> <!doctype html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <script src="https://code.jquery.com/jquery-3.5.1.js" integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script> <link rel="stylesheet" href="css/UHCcustom.css"> <link rel="stylesheet" href="css/home.css"> <link rel="stylesheet" href="css/bootstrap.css"> <link rel="stylesheet" href="css/all.css"> <link rel="stylesheet" href="css/loader.css"> <script src="js/popper-1.14.3.min.js"></script> <script src="js/datatables-1.11.5.min.js"></script> <script src="js/datatables-1.11.4.bootstrap4.min.js"></script> <script src="js/lodash-4.17.10.min.js"></script> <script src="js/UHCcustom.js"></script> <script src="js/bootstrap.min.js"></script> <script src="js/bootstrap-popup.min.js"></script> <script src="js/loader.js"></script> <script src="js/jquery-3.5.1.js"></script> <link rel="stylesheet" href="css/multislect-dropdown.css"> <script type="text/javascript" src="js/bootstrap-multiselect.js"></script> <link rel="stylesheet" href="css/bootstrap-multiselect.css"> <script src="js/app/maximum-management.js"></script> <title>Plan Library</title> <link rel="icon" href="assets/PlanBuilderFavIcon.png"> <style> .table-striped tbody tr.highlight td { background-color: #ff0000; } .table-striped tbody tr.highlight { background-color: #ff0000; } .accordion-body .d-flex button { flex: 1; } .accordion-header .form-check-input { transform: scale(0.4); margin-right: 5px; } .accordion-button:not(.collapsed) .selectable-accordion strong, .accordion-button:not(.collapsed) .selectable-accordion small { color: var(--bs-primary) !important; } </style> <link href="js/frappe-datatable.min.css" rel="stylesheet"> <link rel="stylesheet" href="css/fontawesome.min.css"> <link rel="stylesheet" href="css/brands.min.css"> <link rel="stylesheet" href="css/solid.min.css"> </head> <body> <div id="main"> <%@include file="loader.jsp" %> <%@include file="header.jsp" %> <div class="text-primary" style="margin: 2em;"> <h1><i class="fa-solid fa-filter-circle-dollar"></i> Maximum Management</h1> </div> <div class="shadow-lg p-3 mb-5 bg-white rounded" style="margin:2em"> <form action="./maxManagementSearch" id="bcfilters" method="post" autocomplete="off"> <input type="hidden" id="ifpRoleId" value="${pageContext.session.getAttribute('ifpRoleId')}" /> <input type="hidden" name="validateCoc" id="validateCoc" value="" /> <div class="row"> <c:if test="${enabledCascade == 'true'}"> <span class="modal-title text-danger"> <b>Warning: </b> There are benefit limit changes that have not been cascaded to applicable plans. If you do not cascade these updates, the applicable plans will not receive the changes. If you leave this page the updates will be saved but not cascaded. </span> </c:if> </div> </br> <div class="row"> <div class="col"> <div class="form-floating"> <select id="cocSeries" name="coc" class="form-control" multiple="multiple" onchange="return validateSearch(true),onCocChange();"> <c:forEach var="coc" items="${maximumDD.cocSeriesMap}"> <c:set var="isSelected" value="false"/> <c:forEach var="selectedCoc" items="${fn:split(fn:escapeXml(maxManagementSearchRequest.coc != null ? maxManagementSearchRequest.coc : ''), ',')}"> <c:if test="${fn:trim(selectedCoc) eq coc.key}"> <c:set var="isSelected" value="true"/> </c:if> </c:forEach> <option id="${coc.key}" value="${coc.key}" <c:if test="${isSelected}">selected</c:if>>${coc.value}</option> </c:forEach> </select> </div> </div> <div class="col"> <div class="form-floating"> <select id="state" name="stateName" class="form-control" multiple="multiple" onchange="return validateSearch(true);"> <c:forEach var="state" items="${maximumDD.stateMap}"> <c:set var="isSelected" value="false"/> <c:forEach var="selectedState" items="${fn:split(fn:escapeXml(maxManagementSearchRequest.stateName != null ? maxManagementSearchRequest.stateName : ''), ',')}"> <c:if test="${fn:trim(selectedState) eq state.key}"> <c:set var="isSelected" value="true"/> </c:if> </c:forEach> <option id="${state.key}" value="${state.key}" <c:if test="${isSelected}">selected</c:if>>${state.value}</option> </c:forEach> </select> </div> </div> <div class="col"> <div class="form-floating"> <select id="standard" name="standard" class="form-control" multiple="multiple" onchange="return validateSearch(true);"> <c:forEach var="stand" items="${maximumDD.standardMap}"> <c:set var="isSelected" value="false"/> <c:forEach var="selectedStand" items="${fn:split(fn:escapeXml(maxManagementSearchRequest.standard != null ? maxManagementSearchRequest.standard : ''), ',')}"> <c:if test="${fn:trim(selectedStand) eq stand.key}"> <c:set var="isSelected" value="true"/> </c:if> </c:forEach> <option id="${stand.key}" value="${stand.key}" <c:if test="${isSelected}">selected</c:if>>${stand.value}</option> </c:forEach> </select> </div> </div> </div> <div class="d-flex gap-2 w-100 mb-3 mt-3"> <button type="button" class="btn btn-outline-warning btn-sm flex-fill" title="Change Tracking" ${ (pageContext.session.getAttribute('ifpRoleId')==8 || pageContext.session.getAttribute('ifpRoleId')==9) ? "" : "disabled" } onclick="window.open('./maxMgmtChangeSearch', '_blank');"> <i class="fas fa-exchange-alt"></i> Change Tracking </button> <button class="btn btn-outline-success btn-sm flex-fill" title="Export"> <i class="fas fa-file-export"></i> Export </button> <button type="button" class="btn btn-outline-primary btn-sm flex-fill" data-bs-toggle="modal" id="clone" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : ((pageContext.session.getAttribute('ifpRoleId')==8 || pageContext.session.getAttribute('ifpRoleId')==9 || pageContext.session.getAttribute('roleId')==4) && maxManagementSearchResponse.size()> 0 ?"":"disabled")} data-bs-target="#maxCloneModal" onclick="validateClone();"> <i class="fas fa-clone"></i> Clone Year/State/Product </button> <button type="button" class="btn btn-outline-primary btn-sm flex-fill" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : (pageContext.session.getAttribute('ifpRoleId')==8 || pageContext.session.getAttribute('ifpRoleId')==9 || pageContext.session.getAttribute('roleId')==4 ?"":"disabled")} id="newMaximum" data-bs-toggle="modal" data-bs-target="#editVisitLimitModal"> <i class="fas fa-plus" style="font-size: 20px;"></i> New Parent Maximum </button> <button type="button" class="btn btn-outline-warning btn-sm flex-fill" id="clearMaxManagement" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : ((pageContext.session.getAttribute('roleId')!=7 && maxManagementSearchResponse.size()> 0) ?"":"disabled")} onclick="clearSearch();"> <i class="fas fa-eraser"></i> Clear </button> <button type="submit" class="btn btn-outline-primary btn-sm flex-fill" id="bensearch" ${ pageContext.session.getAttribute('roleId')!=7 && maxManagementSearchResponse.size()==0 ? "disabled" :""} onclick="submitSearchForm();"> <i class="fas fa-search"></i> Search </button> </div> </form> <script type="text/javascript"> showAndHide(); (function() { setMultiSelectDropDown('#cocSeries', 'COC Series*'); setMultiSelectDropDown('#state', 'State*'); setMultiSelectDropDown('#standard', 'Product Family*'); })(); </script> <div> <div class="accordion w-100" id="maxAccordion" style="display: none;"> <c:set var="prevKey" value="" /> <c:forEach var="maximumData" items="${maxManagementSearchResponse}" varStatus="loop"> <c:set var="currentKey" value="${maximumData.benCatName}_${maximumData.cocSeries}_${maximumData.state}_${maximumData.standard}" /> <c:if test="${currentKey ne prevKey}"> <c:set var="subCount" value="0" /> <c:forEach var="tmp" items="${maxManagementSearchResponse}"> <c:if test="${tmp.benCatName == maximumData.benCatName && tmp.cocSeries == maximumData.cocSeries && tmp.state == maximumData.state && tmp.standard == maximumData.standard}"> <c:set var="subCount" value="${subCount + 1}" /> </c:if> </c:forEach> <c:if test="${prevKey != ''}"> </tbody> </table> </div> </div> </div> </div> </c:if> <div class="accordion-item w-100 bt-1"> <h2 class="accordion-header" id="heading${loop.index}"> <div class="d-flex align-items-center w-100"> <input type="checkbox" class="form-check-input me-2" id="selectRowChk_${loop.index}" name="selectedRows" value="${maximumData.maxId}" onclick="toggleSelectRow(${loop.index});"> <div class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapse${loop.index}" aria-expanded="false" aria-controls="collapse${loop.index}"> <div class="d-flex w-100 justify-content-between align-items-center selectable-accordion m-2" id="accordionRow_${loop.index}"> <div class="d-flex align-items-center gap-2"> <strong>${maximumData.benCatName} (${subCount})</strong> <small class="text-muted"> - ${maximumData.cocSeries} - ${maximumData.state} - ${maximumData.standard}</small> </div> <div></div> </div> </div> </div> </h2> <div id="collapse${loop.index}" class="accordion-collapse collapse" aria-labelledby="heading${loop.index}"> <div class="accordion-body"> <div class="d-flex gap-2 mb-2"> <button class="btn btn-outline-danger btn-sm" title="Delete Parent" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } onclick="deleteParentMaximum('${maximumData.benCatName}', '${maximumData.cocSeries}', '${maximumData.state}', '${maximumData.standard}')"> <i class="fas fa-trash"></i> Delete Parent </button> <button class="btn btn-outline-primary btn-sm" title="Copy Parent & Children"> <i class="fas fa-copy"></i> Copy Parent &amp; Children </button> <button class="btn btn-outline-success btn-sm" title="Add Child Maximum" id="addChildMaximum_${loop.index}" data-bs-toggle="modal" data-bs-target="#editVisitLimitModal" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : (pageContext.session.getAttribute('ifpRoleId')==8 || pageContext.session.getAttribute('ifpRoleId')==9 || pageContext.session.getAttribute('roleId')==4 ?"":"disabled")} onclick="openChildMaximumModal('${maximumData.maxId}', '${maximumData.benCatName}', '${maximumData.cocSeries}', '${maximumData.state}', '${maximumData.standard}');"> <i class="far fa-plus" style="font-size: 20px;"></i> Add Child Maximum </button> </div> <input type="hidden" name="benefitCategoryName" id="benefitCategoryName_${loop.index}" value="${maximumData.benCatName}"> <input type="hidden" name="row_${loop.index}" id="row_${loop.index}" value="0"> <input type="hidden" name="rescoc" id="rescoc_${loop.index}" value="${maximumData.cocSeries}"> <input type="hidden" name="resstateName" id="resstateName_${loop.index}" value="${maximumData.state}"> <input type="hidden" name="resstandard" id="resstandard_${loop.index}" value="${maximumData.standard}"> <div class="table-responsive"> <table class="table table-hover table-striped mb-0" id="newmaxtbl"> <thead> <tr> <th scope="col">Sub Category</th> <th scope="col">Visible</th> <th scope="col">Applies To</th> <th scope="col">Cross Applies</th> <th scope="col">Max Type</th> <th scope="col">Max Value</th> <th scope="col">Freq. Type</th> <th scope="col">Freq. Value</th> <th scope="col">Action</th> </tr> </thead> <tbody> </c:if> <tr> <td> ${maximumData.subCategory} <input type="hidden" name="subCategoryName_${loop.index}" id="subCategoryName_${loop.index}" value="${maximumData.subCategory}" /> </td> <td> <c:choose> <c:when test="${maximumData.visible == 'Yes'}"> <i class="fas fa-check-circle text-success" title="Visible"></i> </c:when> <c:when test="${not empty maximumData.visible && maximumData.visible == 'No'}"> <i class="fas fa-times-circle text-danger" title="Not visible"></i> </c:when> <c:otherwise> </c:otherwise> </c:choose> <input type="hidden" id="visible_${loop.index}" value="${maximumData.visible}"> </td> <td> ${maximumData.appliesTo} <input type="hidden" name="appliesTo" id="appliesTo_${loop.index}" value="${maximumData.appliesTo}"> </td> <td> ${maximumData.crossApplies} <input type="hidden" name="crossApplies" id="crossApplies_${loop.index}" value="${maximumData.crossApplies}"> </td> <td> ${maximumData.maxType} <input type="hidden" name="maxType" id="maxType_${loop.index}" value="${maximumData.maxType}"> </td> <td> ${maximumData.maxValue} <input type="hidden" name="maxValue" id="maxValue_${loop.index}" value="${maximumData.maxValue}"> </td> <td> ${maximumData.freqType} <input type="hidden" name="freqType" id="freqType_${loop.index}" value="${maximumData.freqType}"> </td> <td> ${maximumData.freqValue} <input type="hidden" name="freqValue" id="freqValue_${loop.index}" value="${maximumData.freqValue}"> </td> <td> <div class="btn-group btn-group-sm" role="group"> <div class="btn-group"> <button class="btn btn-outline-primary" data-toggle="tooltip" data-placement="bottom" ${pageContext.session.getAttribute('ifpRoleId')==10 || pageContext.session.getAttribute('ifpRoleId')==8 || pageContext.session.getAttribute('ifpRoleId')==9 || pageContext.session.getAttribute('roleId')==4 ?"":"disabled"} title="Edit" data-bs-toggle="modal" data-bs-target="#editVisitLimitModal" data-value="${maximumData.benCatName}^${maximumData.appliesTo}^${maximumData.crossApplies}^${maximumData.maxType}^${maximumData.maxValue}^${maximumData.freqType}^${maximumData.freqValue}^${maximumData.maxId}^${empty maximumData.subCategory ? '' : maximumData.subCategory}^${maximumData.visible}" id="editMaximum" onclick="getMaxID(${maximumData.maxId})"> <i class="fas fa-edit"></i> </button> <input type="hidden" id="editMaximum_${maximumData.maxId}" data-value="${maximumData.benCatName}^${maximumData.appliesTo}^${maximumData.crossApplies}^${maximumData.maxType}^${maximumData.maxValue}^${maximumData.freqType}^${maximumData.freqValue}^${maximumData.maxId}^${empty maximumData.subCategory ? '' : maximumData.subCategory}^${maximumData.visible}"> <button class="btn btn-outline-danger" data-toggle="tooltip" data-placement="bottom" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : (pageContext.session.getAttribute('ifpRoleId')==8 || pageContext.session.getAttribute('ifpRoleId')==9 || pageContext.session.getAttribute('roleId')==4 ?"":"disabled")} title="Deactivate" data-bs-toggle="modal" id="deleteMaximum" onclick="deleteMaximum(${maximumData.maxId})"> <i class="fas fa-trash"></i> </button> </div> </div> </td> </tr> <c:set var="prevKey" value="${currentKey}" /> </c:forEach> <c:if test="${prevKey != ''}"> </tbody> </table> </div> </div> </div> </div> </c:if> <c:if test="${ empty maxManagementSearchResponse || maxManagementSearchResponse.size() == 0}"> <div class="p-3"> <p>No maximums configured. Please add a new maximum to begin or perform another search. </p> </div> </c:if> </div> </div> <div class="modal fade" id="ErrorModal" tabindex="-1" aria-labelledby="ErrorModalLabel" aria-hidden="true"> <div class="modal-dialog modal-dialog-centered"> <div class="modal-content"> <div class="modal-header"> <h5> <span id="Close" class="modal-title text-danger">Error</span> </h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> </div> <div class="modal-body" style="overflow: auto; overflow-wrap: break-word; width: 30em; max-height: 20em;"> <p> <span id="ErrorMesssage"></span> </p> </div> <div class="modal-footer"> <input type="submit" name="ErrorClose" value="Cancel" id="ErrorClose" class="btn btn-outline-danger" data-bs-dismiss="modal" autocomplete="off"> </div> </div> </div> </div> <div class="modal fade" id="editVisitLimitModal"> <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="editVisitLimitModalLabel"></h5> <button type="button" class="btn-close" data-bs-dismiss="modal" onclick="ShowLeaveModel()"></button> </div> <div class="modal-body"> <form class="row g-3"> <input type="hidden" name="maxId" id="maxId" value="" /> <input type="hidden" name="isChildMaximum" id="isChildMaximum" value="false" /> <!-- COC, State, Product Family fields - editable for parent, readonly for child --> <div class="col-4"> <label for="parent_coc">COC Series<span style="color: red;">*</span></label> <input type="text" class="form-control" list="parentCOCs" id="parent_coc" name="parent_coc" placeholder="COC Series" onchange="resetIfInvalid(this)" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" }> <datalist id="parentCOCs"> <c:forEach var="coc" items="${maximumDD.cocSeriesMap}"> <option value="${coc.value}">${coc.value}</option> </c:forEach> </datalist> </div> <div class="col-4"> <label for="parent_state">State<span style="color: red;">*</span></label> <input type="text" class="form-control" list="parentStates" id="parent_state" name="parent_state" placeholder="State" onchange="resetIfInvalid(this)" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" }> <datalist id="parentStates"> <c:forEach var="state" items="${maximumDD.stateMap}"> <option value="${state.value}">${state.value}</option> </c:forEach> </datalist> </div> <div class="col-4"> <label for="parent_productFamily">Product Family<span style="color: red;">*</span></label> <input type="text" class="form-control" list="parentStandards" id="parent_productFamily" name="parent_productFamily" placeholder="Product Family" onchange="resetIfInvalid(this)" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" }> <datalist id="parentStandards"> <c:forEach var="stand" items="${maximumDD.standardMap}"> <option value="${stand.value}">${stand.value}</option> </c:forEach> </datalist> </div> <div class="visitlimit_benCat"> <label for="visitlimit_benCatType">Benefit Category<span style="color: red;">*</span></label> <select id="visitlimit_bencat_Type" class="form-control adddvisitlimitbutaction" data-toggle="tooltip" data-placement="top" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } title="Required - Select a Benefit Category type."> <option selected value="">Select...</option> <c:forEach var="benCat" items="${benefitCategoryNames}"> <option id="${benCat}" name="${benCat}">${benCat}</option> </c:forEach> </select> </div> <div class="visitlimit_subcategory"> <label for="visitlimit_subcategory">Sub Category</label> <select id="visitlimit_subcategory" class="form-control adddvisitlimitbutaction" data-toggle="tooltip" data-placement="top" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } title="Optional - Select a subcategory."> <option selected value="">Select...</option> <c:forEach var="subCat" items="${subCategory}"> <option id="${subCat}" name="${subCat}">${subCat}</option> </c:forEach> </select> </div> <div class="col-3"> <label for="visitlimit_1_limitType">Max Type</label> <select id="visitlimit_1_limitType" class="form-control adddvisitlimitbutaction" data-toggle="tooltip" data-placement="top" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } title="Required - Select a max type."> <option selected value="">Select...</option> <c:forEach var="limitType" items="${limitTypes}"> <option id="${limitType}" name="${limitType}">${limitType} </option> </c:forEach> </select> </div> <div class="col-3"> <label for="visitlimit_1_limitValue">Max Value</label> <input id="visitlimit_1_limitValue" type="text" min=1 max=999999 oninput="validity.valid||(value='');" class="form-control adddvisitlimitbutaction" placeholder="" data-toggle="tooltip" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } onchange="validateLimitValue(this)" data-placement="top" title="Required - Enter a number greater than 1."></input> </div> <div class="col-3"> <label for="visitlimit_1_limitFreq">Frequency Value</label> <input id="visitlimit_1_limitFreq" type="number" min=1 max=9999 oninput="validity.valid||(value='');" class="form-control adddvisitlimitbutaction" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } placeholder="" data-toggle="tooltip" data-placement="top"></input> </div> <div class="col-3"> <label for="visitlimit_1_limitFreqType">Frequency Type</label> <select id="visitlimit_1_limitFreqType" class="form-control adddvisitlimitbutaction" data-toggle="tooltip" data-placement="top" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } title="Required - Select Months, Years, or Lifetime."> <option selected value="">Select...</option> <c:forEach var="frequencyType" items="${frequencyTypes}"> <option id="${frequencyType}" name="${frequencyType}"> ${frequencyType}</option> </c:forEach> </select> </div> <div class="dropdown-divider"></div> <div class="form-group col-4"> <label for="visitlimit_limitCross_Applies"> Cross Applies</label> <select id="visitlimit_limitCrossApplies" class="form-control adddvisitlimitbutaction" data-toggle="tooltip" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } data-placement="top"> <option selected value="">Select...</option> <c:forEach var="crossApply" items="${crossApplies}"> <option id="${crossApply}" name="${crossApply}">${crossApply} </option> </c:forEach> </select> </div> <div class="form-group col-4"> <label for="visitlimit_limit_Applies">Applies To</label> <select id="visitlimit_limitApplies" class="form-control " data-toggle="tooltip" data-placement="top" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } title="Optional - Select applies to this limit."> <option selected value=" ">Select...</option> <c:forEach var="applies" items="${appliesTo}"> <option id="${applies}" name="${applies}">${applies}</option> </c:forEach> </select> </div> <div class="form-group col-4"> <label for="visitlimit_visible">Visible</label> <select id="visitlimit_visible" class="form-control adddvisitlimitbutaction" data-toggle="tooltip" data-placement="top" ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } title="Required - Select Yes or No."> <option selected value="">Select...</option> <c:forEach var="visibleOption" items="${visible}"> <option id="${visibleOption}" name="${visibleOption}"> ${visibleOption}</option> </c:forEach> </select> </div> <div class="form-group col-4"></div> <div class="dropdown-divider"></div> <div class="col-2"> <div class="d-grid gap-2"> <button type="button" class="btn btn-block btn-outline-danger" data-bs-dismiss="modal" onclick="ShowLeaveModel()"> Cancel </button> </div> </div> <div class="col-2"> <div class="d-grid gap-2"> <button type="button" class="btn btn-block btn-outline-warning" ${pageContext.session.getAttribute("IfpRoleId")==10 ? "" : "disabled" } id="editVisitLimitModalClearBut">Clear </button> </div> </div> <div class="delete-maximum col-2"> <div class="d-grid gap-2"> <button type="button" class="btn btn-block btn-outline-danger" data-toggle="modal" data-target="#deltevisitlimitConf" id="editVisitLimitModalDeleteBut" ${pageContext.session.getAttribute("IfpRoleId")==10 ? "" : "disabled" } onclick="deleteMaximumFromEdit();">Delete </button> </div> </div> <div class="col-2"> <div class="d-grid gap-2"> <button type="button" class="btn btn-block btn-outline-primary" id="editVisitLimitModalSaveBut" ${pageContext.session.getAttribute("IfpRoleId")==10 ? "disabled" : "" } onclick="validateCoc('maxSave')" disabled>Save </button> </div> </div> </form> </div> </div> </div> </div> <div class="modal fade" id="sucessBoxNewMaximumModal" tabindex="-1" role="dialog" aria-labelledby="sucessBoxNewMaximumModalLabel" aria-hidden="true" data-bs-backdrop='static'> <div class="modal-dialog modal-dialog-centered" role="document"> <div class="modal-content"> <div class="modal-header"> <h5><span id="lblWarnTitle" class="modal-title text-success"> Success </span> </h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="reloadSearch();"></button> </div> <div class="modal-body" id="successResult"> </div> </div> </div> </div> <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true"> <div class="modal-dialog modal-dialog-centered" role="document"> <div class="modal-content"> <div class="modal-header"> <h5><span id="ErrorClose" class="modal-title text-danger">Error</span></h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="reloadSearch();"></button> </div> <div class="modal-body" id="errorMesssage"></div> </div> </div> </div> <div class="modal fade" id="deleteParentConfirmBoxModal" tabindex="-1" role="dialog" aria-labelledby="deleteParentConfirmBoxModal" aria-hidden="true"> <div class="modal-dialog modal-dialog-centered" role="document"> <div class="modal-content"> <div class="modal-header"> <h5><span id="lblParentWarnTitle" class="modal-title text-danger"> Warning </span></h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> </div> <div class="modal-body"> <input type="hidden" name="benCatName" id="benCatName" value="" /> <input type="hidden" name="cocSeries" id="cocSeries" value="" /> <input type="hidden" name="state" id="state" value="" /> <input type="hidden" name="standard" id="standard" value="" /> Please confirm that you'd like to delete this selected parent plan? </div> <div class="modal-footer"> <input type="submit" value="Cancel" id="deleteParentClose" class="btn btn-outline-danger" data-bs-dismiss="modal" autocomplete="off"> <a onclick="deleteParentMaximumConfirm()" id="deleteParentConfirmVal" class="btn btn-outline-success" data-dismiss="modal">Confirm</a> </div> </div> </div> </div> <div class="modal fade" id="deleteConfirmBoxModal" tabindex="-1" role="dialog" aria-labelledby="deleteConfirmBoxModal" aria-hidden="true"> <div class="modal-dialog modal-dialog-centered" role="document"> <div class="modal-content"> <div class="modal-header"> <h5><span id="lblWarnTitle" class="modal-title text-danger"> Warning </span> </h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> </div> <div class="modal-body"> <input type="hidden" name="maxIdVal" id="maxIdVal" value="" /> Please confirm that you'd like to delete this selected plan? </div> <div class="modal-footer"> <input type="submit" value="Cancel" id="deleteClose" class="btn btn-outline-danger" data-bs-dismiss="modal" autocomplete="off"> <a onclick="deleteMaximumData()" id="deleteConfirmVal" class="btn btn-outline-success" data-dismiss="modal">Confirm</a> </div> </div> </div> </div> <!-- Clone Modal --> <div class="modal fade" id="maxCloneModal" tabindex="-1" aria-labelledby="maxCloneModalLabel" aria-hidden="true"> <div class="modal-dialog modal-dialog-centered"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="maxCloneModalLabel">Clone New Maximum Configuration </h5> <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> </div> <!-- START: NEW clone modal body (replace existing single-field block) --> <div class="modal-body"> <!-- Hidden fields to carry values (backend can read these) --> <input type="hidden" name="cloneBenefitCategoryName" id="cloneBenefitCategoryName"> <input type="hidden" name="cloneAppliesTo" id="cloneAppliesTo"> <input type="hidden" name="cloneCrossAppliesTo" id="cloneCrossAppliesTo"> <input type="hidden" name="cloneMaxType" id="cloneMaxType"> <input type="hidden" name="cloneMaxValue" id="cloneMaxValue"> <input type="hidden" name="cloneFreqType" id="cloneFreqType"> <input type="hidden" name="cloneFreqValue" id="cloneFreqValue"> <div class="row g-2"> <!-- COC pair --> <div class="col-6"> <div class="form-floating"> <input type="text" class="form-control" list="fromCOCs" name="fromCocSeries" id="fromCocSeries" placeholder="From COC Series" onchange="resetIfInvalid(this); enableClone(this); getCloneIfpDropdowns();"> <label for="fromCocSeries" class="form-label">From COC Series</label> <datalist id="fromCOCs"> <c:forEach var="coc" items="${cocSeries}"> <option id="${coc.cocSeries}">${coc.cocSeries}</option> </c:forEach> </datalist> </div> </div> <div class="col-6"> <div class="form-floating"> <input type="text" class="form-control" list="toCOCs" name="toCocSeries" id="toCocSeries" placeholder="To COC Series" onchange="resetIfInvalid(this); enableClone(this); getCloneIfpDropdowns();"> <label for="toCocSeries" class="form-label">To COC Series</label> <datalist id="toCOCs"> <c:forEach var="coc" items="${cocSeries}"> <option id="${coc.cocSeries}">${coc.cocSeries}</option> </c:forEach> </datalist> </div> </div> <!-- State pair --> <div class="col-6"> <div class="form-floating"> <input type="text" class="form-control" list="fromStates" name="fromState" id="fromState" placeholder="From State" onchange="resetIfInvalid(this); enableClone(this);"> <label for="fromState" class="form-label">From State</label> <datalist id="fromStates"> <c:forEach var="state" items="${maximumDD.stateMap}"> <option id="${state.key}">${state.value}</option> </c:forEach> </datalist> </div> </div> <div class="col-6"> <div class="form-floating"> <input type="text" class="form-control" list="toStates" name="toState" id="toState" placeholder="To State" onchange="resetIfInvalid(this); enableClone(this);"> <label for="toState" class="form-label">To State</label> <datalist id="toStates"> <c:forEach var="state" items="${maximumDD.stateMap}"> <option id="${state.key}">${state.value}</option> </c:forEach> </datalist> </div> </div> <!-- Product family (standard) pair --> <div class="col-6"> <div class="form-floating"> <input type="text" class="form-control" list="fromStandards" name="fromStandard" id="fromStandard" placeholder="From Product Family" onchange="resetIfInvalid(this); enableClone(this);"> <label for="fromStandard" class="form-label">From Product Family</label> <datalist id="fromStandards"> <c:forEach var="stand" items="${maximumDD.standardMap}"> <option id="${stand.key}">${stand.value}</option> </c:forEach> </datalist> </div> </div> <div class="col-6"> <div class="form-floating"> <input type="text" class="form-control" list="toStandards" name="toStandard" id="toStandard" placeholder="To Product Family" onchange="resetIfInvalid(this); enableClone(this);"> <label for="toStandard" class="form-label">To Product Family</label> <datalist id="toStandards"> <c:forEach var="stand" items="${maximumDD.standardMap}"> <option id="${stand.key}">${stand.value}</option> </c:forEach> </datalist> </div> </div> </div> </div> <!-- END: NEW clone modal body --> <div class="modal-footer"> <button type="button" class="btn btn-warning" data-bs-dismiss="modal">Cancel</button> <button type="button" class="btn btn-success" disabled="" id="clonebtn" onclick="cloneAjaxWithBenCatCheck();">Clone</button> </div> </div> </div> </div> <!-- Modal --> <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="exampleModalLabel">Leave site?</h5> <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> </div> <div class="modal-body"> Changes you made may not be saved. </div> <div class="modal-footer"> <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="closeUpdateModel()">Leave</button> <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Cancel</button> </div> </div> </div> </div> <div style="position: fixed; top: 1%; right: 40%; z-index: 1;" class="toast" data-autohide="false" id="success"> <div class="toast-header"> <strong class="mr-auto text-primary"> <i class="fas fa-square" style="color: #00a550"></i>Success </strong> <button type="button" style="margin-left: 13rem;" class="btn-close" data-bs-dismiss="toast"></button> </div> <div class="toast-body" style="background-color: #E8E8E8" id="successMessage"></div> </div> <div class="modal fade" id="cascadeLeaveModal" tabindex="-1" role="dialog" aria-labelledby="cascadeLeaveModalLabel" aria-hidden="true"> <div class="modal-dialog" role="document"> <div class="modal-content"> <div class="modal-header"> <h5 class="modal-title" id="cascadeLeaveLabel">Leave site?</h5> <button type="button" class="close" data-bs-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> </div> <div class="modal-body"> Warning: there are benefit limit changes that have not been cascaded to applicable plans. If you do not cascade these updates, the applicable plans will not receive the changes. If you leave this page the updates will be saved but not cascaded. </div> <div class="modal-footer"> <a type="button" class="btn btn-secondary" data-bs-dismiss="modal" href="${pageContext.session.getAttribute('planlibraryUrl')}">Leave</a> <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="restricBrowserClose()">Cancel</button> </div> </div> </div> </div> </div> <%@include file="footer.html" %> </div> </body> </html>

js to understand existing clone -

function maximumDelete(maxId){ showAndHide(); $.ajax({ type: "Delete", contentType: "application/json", url: "deleteMaximum"+'/'+maxId, dataType: 'json', success: function(response) { document.getElementById("successHeader").innerHTML = 'Deactivated'; document.getElementById("successMessage").innerHTML = 'Maximum Deactivated Successfully.'; $("#success").toast("show"); }, error: function(xhr) { console.log("error",xhr); alert("Something went wrong while deleting program, please try again..!"); } }); reloadSearch(); } function reloadSearch(){ $("#cocSeries").val(""); $("#stateName").val(""); $("#standard").val(""); window.location.href="./maxManagement"; } function validateSearch(flag) { console.log("search"); var coc = $('#cocSeries').val(); var state = $('#state').val(); var stand = $('#standard').val(); let cocSeries= coc.length > 0 ? coc.toString() : ""; let states= state.length > 0 ? state.toString() : ""; let standards= stand.length > 0 ? stand.toString() : ""; if(flag) { if(cocSeries === ""||states === ""||standards === "") { document.getElementById('bensearch').disabled = true; return false; } document.getElementById('bensearch').disabled = false; return true; } if(cocSeries === ""||states === ""||standards === "") { document.getElementById('bensearch').disabled = true; document.getElementById('newMaximum').disabled = true; document.getElementById("ErrorMesssage").innerHTML = 'Please select all filters to search'; $("#ErrorModal").modal("toggle"); return false; } return true; } function onlyNumberKey(evt){ var ASCIICode = (evt.which) ? evt.which : evt.keyCode if (ASCIICode > 31 && (ASCIICode < 48 || ASCIICode > 57)){ document.getElementById("ErrorMesssage").innerHTML = 'COC Series should be Numeric'; $("#ErrorModal").modal("toggle"); return false; } enterKeyPressed(evt); return true; } function clearSearch(){ console.log("clearMaxManagement"); $("#cocSeries").val(""); $("#stateName").val(""); $("#standard").val(""); window.location.href="./maxManagement"; } function submitSearchForm() { document.getElementById('bcfilters').submit(); } function setMultiSelectDropDown(id, fieldName) { $(id).multiselect({ filterPlaceholder: 'Search for ' + fieldName + '...', enableFiltering: true, enableCaseInsensitiveFiltering: true, includeSelectAllOption: true, maxHeight: 400, dropUp: true, nonSelectedText: fieldName }); } var bcOldValue; var flagModel; let initialFormState = {}; $(document).ready(function() { showAndHide(); $('#maxAccordion').show(); var coc = $('#cocSeries').val(); var state = $('#state').val(); var stand = $('#standard').val(); let cocSeries= coc.length > 0 ? coc.toString() : ""; let stateSeries= state.length > 0 ? state.toString() : ""; let standSeries= stand.length > 0 ? stand.toString() : ""; if(cocSeries === ""||stateSeries === ""||standSeries === "") { document.getElementById('bensearch').disabled = true; document.getElementById('newMaximum').disabled = false; document.getElementById('clone').disabled = true; } $('#editVisitLimitModal').on('hidden.bs.modal', function (e) { var validateCoc = document.getElementById("validateCoc").value; if(validateCoc != 1){ $('#editVisitLimitModalSaveBut').removeAttr("disabled"); $('#editVisitLimitModalSaveBut').html("Save"); $("#visitlimit_addlimitbuttonid").attr("enabled", "true"); $("#visitlimit_addlimitbuttonid").html("Add Limit"); $("#visitlimit_bencat_Type").val(""); $("#visitlimit_subcategory").val(""); $("#visitlimit_1_limitType").val(""); $("#visitlimit_1_limitValue").val(""); $("#visitlimit_1_limitFreq").val(""); $("#visitlimit_1_limitFreqType").val(""); $("#visitlimit_limitCrossApplies").val(""); $("#visitlimit_limitApplies").val(""); $("#visitlimit_visible").val(""); $("#maxId").val(""); $("#isChildMaximum").val("false"); $("#parent_coc").prop('readonly', false).removeAttr('readonly'); $("#parent_state").prop('readonly', false).removeAttr('readonly'); $("#parent_productFamily").prop('readonly', false).removeAttr('readonly'); $("#visitlimit_bencat_Type").prop('disabled', false).removeAttr('disabled'); $("#parent_coc").val(""); $("#parent_state").val(""); $("#parent_productFamily").val(""); $('#editVisitLimitModalLabel').html(''); } }); $('#editVisitLimitModal').on('shown.bs.modal', function (e) { $('#editVisitLimitModalSaveBut').attr("disabled","true"); $("#visitlimit_addlimitbuttonid").attr("disabled","true"); $("#visitlimit_addlimitbuttonid").html("Add Limit"); if (e.relatedTarget.id == 'newMaximum') { $('#editVisitLimitModalLabel').html('Add Parent Maximum'); $("#isChildMaximum").val("false"); $("#parent_coc").val(""); $("#parent_state").val(""); $("#parent_productFamily").val(""); $("#visitlimit_bencat_Type").val(""); $("#visitlimit_subcategory").val(""); $("#visitlimit_1_limitType").val(""); $("#visitlimit_1_limitValue").val(""); $("#visitlimit_1_limitFreq").val(""); $("#visitlimit_1_limitFreqType").val(""); $("#visitlimit_visible").val(""); $("#visitlimit_limitCrossApplies").val(""); $("#visitlimit_limitApplies").val(""); $("#maxId").val(""); $("#parent_coc").prop('readonly', false).removeAttr('readonly'); $("#parent_state").prop('readonly', false).removeAttr('readonly'); $("#parent_productFamily").prop('readonly', false).removeAttr('readonly'); $("#visitlimit_bencat_Type").prop('disabled', false).removeAttr('disabled'); $('#editVisitLimitModalClearBut').prop('disabled', true); flagModel = true; $(".delete-maximum").hide(); } else if (e.relatedTarget.id && e.relatedTarget.id.startsWith('addChildMaximum')) { // New Child Maximum - All fields already populated by openChildMaximumModal() $('#editVisitLimitModalLabel').html('Add Child Maximum'); flagModel = true; $(".delete-maximum").hide(); } else if (e.relatedTarget.id == 'editMaximum') { $(".delete-maximum").show(); $('#editVisitLimitModalLabel').html('Edit Maximum'); $("#isChildMaximum").val("false"); var accordionItem = $(e.relatedTarget).closest('.accordion-item'); var cocSeries = accordionItem.find('input[name="rescoc"]').val(); var state = accordionItem.find('input[name="resstateName"]').val(); var standard = accordionItem.find('input[name="resstandard"]').val(); $("#parent_coc").val(cocSeries); $("#parent_state").val(state); $("#parent_productFamily").val(standard); $("#parent_coc").prop('readonly', true); $("#parent_state").prop('readonly', true); $("#parent_productFamily").prop('readonly', true); $("#visitlimit_bencat_Type").prop('disabled', true); var maximumData = $(e.relatedTarget).data('value'); const arrMaxData = maximumData.split("^"); $("#visitlimit_bencat_Type").val(arrMaxData[0]); $("#visitlimit_limitApplies").val(arrMaxData[1]); $("#visitlimit_limitCrossApplies").val(arrMaxData[2]); $("#visitlimit_1_limitType").val(arrMaxData[3]); $("#visitlimit_1_limitValue").val(arrMaxData[4]); $("#visitlimit_1_limitFreqType").val(arrMaxData[5]); $("#visitlimit_1_limitFreq").val(arrMaxData[6]); $("#maxId").val(arrMaxData[7]); $("#visitlimit_subcategory").val(arrMaxData[8] || ""); $("#visitlimit_visible").val(arrMaxData[9]); $('#editVisitLimitModalClearBut').prop('disabled', false); flagModel = false; bcOldValue = document.getElementById("visitlimit_bencat_Type").value; initialFormState = {}; $('#editVisitLimitModal .adddvisitlimitbutaction, #editVisitLimitModal input, #editVisitLimitModal select').each(function () { initialFormState[this.id] = $(this).val(); }); } }); $('#editVisitLimitModalClearBut').on('click', function (e) { $('#editVisitLimitModalSaveBut').attr("disabled", "true"); var isChildMaximum = document.getElementById("isChildMaximum").value === "true"; if (!isChildMaximum) { $("#parent_coc").val(""); $("#parent_state").val(""); $("#parent_productFamily").val(""); $("#visitlimit_bencat_Type").val(""); } $("#visitlimit_subcategory").val(""); $("#visitlimit_1_limitType").val(""); $("#visitlimit_1_limitValue").val(""); $("#visitlimit_1_limitFreq").val(""); $("#visitlimit_1_limitFreqType").val(""); $("#visitlimit_limitCrossApplies").val(""); $("#visitlimit_limitApplies").val(""); $("#visitlimit_visible").val(""); $("#maxId").val(""); }); $(document).on('input change', '#editVisitLimitModal .adddvisitlimitbutaction, #editVisitLimitModal input, #editVisitLimitModal select', function () { let ifpRoleId = Number(document.getElementById('ifpRoleId').value); // Make sure this hidden field exists and is set if (ifpRoleId === 10) { $('#editVisitLimitModalSaveBut').prop('disabled', true); return; } var isChildMaximum = document.getElementById("isChildMaximum").value === "true"; let hasAnyValue = false; if (isChildMaximum) { hasAnyValue = $("#visitlimit_subcategory").val() || $("#visitlimit_1_limitType").val() || $("#visitlimit_1_limitValue").val() || $("#visitlimit_1_limitFreq").val() || $("#visitlimit_1_limitFreqType").val() || $("#visitlimit_visible").val() || $("#visitlimit_limitCrossApplies").val() || $("#visitlimit_limitApplies").val(); } else { hasAnyValue = $("#parent_coc").val() || $("#parent_state").val() || $("#parent_productFamily").val() || $("#visitlimit_bencat_Type").val() || $("#visitlimit_subcategory").val() || $("#visitlimit_1_limitType").val() || $("#visitlimit_1_limitValue").val() || $("#visitlimit_1_limitFreq").val() || $("#visitlimit_1_limitFreqType").val() || $("#visitlimit_visible").val() || $("#visitlimit_limitCrossApplies").val() || $("#visitlimit_limitApplies").val(); } $('#editVisitLimitModalClearBut').prop('disabled', !hasAnyValue); if (isChildMaximum) { var limitType = $("#visitlimit_1_limitType").val(); var limitValue = $("#visitlimit_1_limitValue").val(); if (limitType && limitValue) { $('#editVisitLimitModalSaveBut').prop('disabled', false); } else { $('#editVisitLimitModalSaveBut').prop('disabled', true); } } else { let hasChanged = false; $('#editVisitLimitModal .adddvisitlimitbutaction, #editVisitLimitModal input, #editVisitLimitModal select').each(function () { if (initialFormState[this.id] !== $(this).val()) { hasChanged = true; return false; } }); $('#editVisitLimitModalSaveBut').prop('disabled', !hasChanged); } }); $("#visitlimit_bencat_Type").change(function () { if (($("#visitlimit_bencat_Type").val()) == "") { $('#editVisitLimitModalSaveBut').attr("disabled","true"); } else { $('#editVisitLimitModalSaveBut').removeAttr("disabled"); } }); document.getElementById("cocSeries").addEventListener("input", function () { if ($('#cocSeries').val() === null || $('#cocSeries').val().length === 0) { onCocChange(); } }); }); function saveNewMaximumWithBenCatCheck() { if(flagModel) { console.log("New Maximum Mgmt flagModel : ",flagModel); isNewMaximumMgmtBenCatExist(); } else { console.log("Edit Maximum Mgmt flagModel : ",flagModel); var bcNewValue = document.getElementById("visitlimit_bencat_Type").value; if(bcNewValue == bcOldValue) { saveNewMaximum(); } else { isNewMaximumMgmtBenCatExist(); } } } function isNewMaximumMgmtBenCatExist() { console.log("isNewMaximumMgmtBenCatExist"); checkNewMaximumMgmtBenCatExist().then(response => { if(response != null) { if(response.identicalCount == 0) { saveNewMaximum(); } else { //showAndHide(); $("#editVisitLimitModal").modal('hide'); document.getElementById("errorMesssage").innerHTML = 'The combination that you entered already exists.'; $("#errorModal").modal("toggle"); } } else { $("#editVisitLimitModal").modal('hide'); document.getElementById("ErrorMesssage").innerHTML = 'Something went wrong, please try again..!'; $("#ErrorModal").modal("toggle"); } }); } function checkNewMaximumMgmtBenCatExist() { console.log("checkNewMaximumMgmtBenCatExist"); var request = {}; request['cocSeries'] = $("#parent_coc").val(); request['state'] = $("#parent_state").val(); request['standard'] = $("#parent_productFamily").val(); request['benCatName'] = document.getElementById("visitlimit_bencat_Type").value; request['subCategory'] = document.getElementById("visitlimit_subcategory").value || ""; request['appliesTo'] = document.getElementById("visitlimit_limitApplies").value; request['maxType'] = document.getElementById("visitlimit_1_limitType").value; request['maxValue'] = document.getElementById("visitlimit_1_limitValue").value; request['freqValue'] = document.getElementById("visitlimit_1_limitFreq").value; request['freqType'] = document.getElementById("visitlimit_1_limitFreqType").value; request['visible'] = document.getElementById("visitlimit_visible").value; request['crossApplies'] = document.getElementById("visitlimit_limitCrossApplies").value; if (request.benCatName != ''){ return $.ajax({ type: "POST", contentType: "application/json", url: "isBenCatExistForNewMaximumMgmt", data: JSON.stringify(request), dataType: 'json' }); } else { // showAndHide(); $("#editVisitLimitModal").modal('hide'); document.getElementById("errorMesssage").innerHTML = 'Please select Benefit Category Name'; $("#errorModal").modal("toggle"); } return null; } function saveNewMaximum(){ console.log("saveNewMaximum"); var request = {}; request['cocSeries'] = $("#parent_coc").val(); request['state'] = $("#parent_state").val(); request['standard'] = $("#parent_productFamily").val(); var maxId = document.getElementById("maxId").value; if (maxId != '') { console.log("There is no maxId id: Its a new plan"); console.log("Editing existing maximum with maxId: ", maxId); request['maxId'] = maxId; } request['benCatName'] = document.getElementById("visitlimit_bencat_Type").value; request['subCategory'] = document.getElementById("visitlimit_subcategory").value || ""; request['maxType'] = document.getElementById("visitlimit_1_limitType").value; request['maxValue'] = document.getElementById("visitlimit_1_limitValue").value; request['freqValue'] = document.getElementById("visitlimit_1_limitFreq").value; request['freqType'] = document.getElementById("visitlimit_1_limitFreqType").value; request['crossApplies'] = document.getElementById("visitlimit_limitCrossApplies").value; request['appliesTo'] = document.getElementById("visitlimit_limitApplies").value; request['visible'] = document.getElementById("visitlimit_visible").value; request['status'] = 'Active'; saveNewMaximumData(request); } function saveNewMaximumData(request) { console.log("saveNewMaximumData"); if (request.benCatName != ''){ $.ajax({ type: "POST", contentType: "application/json", url: "saveNewMaximum", data: JSON.stringify(request), dataType: 'json', success: function (res) { $("#editVisitLimitModal").modal('hide'); console.log(res); if (res.newMaximums == 0) { document.getElementById("errorMesssage").innerHTML = 'The combination that you entered, already exists.'; $("#errorModal").modal("show"); } else { document.getElementById("successResult").innerHTML = 'Maximum Successfully Saved'; $("#sucessBoxNewMaximumModal").modal("show"); } }, error: function (xhr) { console.log("error",xhr); alert("Something went wrong while saving plans, please try again..!"); } }); } } function deleteMaximum(maxIdVal){ $("#deleteConfirmBoxModal").modal("toggle"); $('#maxIdVal').val(maxIdVal); } function deleteParentMaximum(benCatName, cocSeries, state, standard) { console.log(benCatName, cocSeries, state, standard); $("#deleteParentConfirmBoxModal").modal("toggle"); $('#benCatName').val(benCatName); $('#cocSeries').val(cocSeries); $('#state').val(state); $('#standard').val(standard); } function deleteParentMaximumConfirm() { var benCatNameVal=document.getElementById("benCatName").value; var cocSeriesVal=document.getElementById("cocSeries").value; var stateVal=document.getElementById("state").value; var standardVal=document.getElementById("standard").value; console.log(benCatNameVal, cocSeriesVal, stateVal, standardVal); $.ajax({ url: "deleteParentMaximum", type: "POST", contentType: "application/json", data: JSON.stringify({ benCatName: benCatNameVal, cocSeries: cocSeriesVal, state: stateVal, standard: standardVal }), success: function(response) { $("#deleteParentConfirmBoxModal").modal('hide'); document.getElementById("successResult").innerHTML = 'Maximum Successfully Deleted'; $("#sucessBoxNewMaximumModal").modal("toggle"); }, error: function(xhr) { console.error('error', xhr); alert('Something went wrong while Deleting plans, please try again..!'); } }); } function deleteMaximumData() { var request = document.getElementById("maxIdVal").value; if (request != ''){ $.ajax({ type: "POST", contentType: "application/json", url: "deletePlanConfirm", data: JSON.stringify(request), dataType: 'json', success: function (res) { $("#deleteConfirmBoxModal").modal('hide'); console.log(res); document.getElementById("successResult").innerHTML = 'Maximum Successfully Deleted'; $("#sucessBoxNewMaximumModal").modal("toggle"); }, error: function (xhr) { console.log("error",xhr); alert("Something went wrong while Deleting plans, please try again..!"); } }); } } function deleteMaximumFromEdit() { var maxId = document.getElementById("maxId").value; $("#editVisitLimitModal").modal('hide'); deleteMaximum(maxId); } function validateClone() { const anyRow = document.querySelector('input[id^="editMaximum_"]'); if (anyRow) { const parts = (anyRow.getAttribute('data-value') || '').split('^'); const benCat = parts[0] || ''; const cocInput = document.querySelector('input[id^="rescoc_"]'); const stateInput = document.querySelector('input[id^="resstateName_"]'); const standardInput = document.querySelector('input[id^="resstandard_"]'); if (cocInput) document.getElementById("cloneCoc").value = cocInput.value || ""; if (stateInput) document.getElementById("cloneState").value = stateInput.value || ""; if (standardInput) document.getElementById("cloneStandard").value = standardInput.value || ""; document.getElementById("cloneBenefitCategoryName").value = benCat; document.getElementById("cloneAppliesTo").value = parts[1] || ''; document.getElementById("cloneCrossAppliesTo").value = parts[2] || ''; document.getElementById("cloneMaxType").value = parts[3] || ''; document.getElementById("cloneMaxValue").value = parts[4] || ''; document.getElementById("cloneFreqType").value = parts[5] || ''; document.getElementById("cloneFreqValue").value = parts[6] || ''; } document.getElementById('clonebtn').disabled = false; $("#maxCloneModal").modal("toggle"); } function cloneAjaxWithBenCatCheck() { isBenCatExistForClone().then(response => { if(response != null) { if(response.duplicateCount == 0) { cloneAjax(); } else { $("#maxCloneModal").modal('hide'); document.getElementById("errorMesssage").innerHTML = 'The combination that you are entered is already exist.'; $("#errorModal").modal("toggle"); } } else { showAndHide(); $("#maxCloneModal").modal('hide'); document.getElementById("ErrorMesssage").innerHTML = 'Something went wrong, please try again..!'; $("#ErrorModal").modal("toggle"); } }); } function isBenCatExistForClone() { const coc = document.getElementById("cloneCoc").value; const state = document.getElementById("cloneState").value; const stand = document.getElementById("cloneStandard").value; const cloneNewMaximumRequestList = []; let rowCounter = 1; document.querySelectorAll('input[id^="editMaximum_"]').forEach(function (rowInput) { const ds = rowInput.getAttribute('data-value') || ''; const parts = ds.split('^'); if (parts.length < 7) return; const payload = { cloneCoc: coc, cloneState: state, cloneStandard: stand, cloneBenefitCategoryName: parts[0] || '', cloneAppliesTo: parts[1] || '', cloneCrossApplies: parts[2] || '', cloneMaxType: parts[3] || '', cloneMaxValue: parts[4] || '', cloneFreqType: parts[5] || '', cloneFreqValue: parts[6] || '', cloneSubCategory: parts[8] || '', cloneVisible: parts[9] || '', row: rowCounter++ }; if (payload.cloneBenefitCategoryName) { cloneNewMaximumRequestList.push(payload); } }); return $.ajax({ type: "POST", contentType: "application/json", url: "isBenCatExistForClone", data: JSON.stringify({ cloneMaximumManagementRequestList: cloneNewMaximumRequestList }), dataType: 'json' }); } function cloneAjax() { const coc = document.getElementById("cloneCoc").value; const state = document.getElementById("cloneState").value; const stand = document.getElementById("cloneStandard").value; const cloneNewMaximumRequestList = []; let rowCounter = 1; document.querySelectorAll('input[id^="editMaximum_"]').forEach(function (rowInput) { const ds = rowInput.getAttribute('data-value') || ''; const parts = ds.split('^'); if (parts.length < 7) return; const payload = { cloneCoc: coc, cloneState: state, cloneStandard: stand, cloneBenefitCategoryName: parts[0] || '', cloneAppliesTo: parts[1] || '', cloneCrossApplies: parts[2] || '', cloneMaxType: parts[3] || '', cloneMaxValue: parts[4] || '', cloneFreqType: parts[5] || '', cloneFreqValue: parts[6] || '', cloneSubCategory: parts[8] || '', cloneVisible: parts[9] || '', row: rowCounter++ }; if (payload.cloneBenefitCategoryName) { cloneNewMaximumRequestList.push(payload); } }); showAndHide(); $.ajax({ type: "POST", contentType: "application/json", url: "cloneMaxManagement", data: JSON.stringify({ cloneMaximumManagementRequestList: cloneNewMaximumRequestList }), dataType: 'json', success: function (res) { showAndHide(); document.getElementById("successMessage").innerHTML = res.saveSuccess; $("#success").toast("show"); $("#maxCloneModal").modal("toggle"); }, error: function (xhr) { showAndHide(); document.getElementById("ErrorMesssage").innerHTML = 'Something went wrong, please try again..!'; $("#maxCloneModal").modal("toggle"); $("#ErrorModal").modal("toggle"); } }); } function enableClone(lists) { document.getElementById('clonebtn').disabled = false; document.getElementById('clonebtn').focus(); return false; } function onCocChange(){ showAndHide(); var standard = $('#standard').val(); var cocName = $('#cocSeries').val(); let cocSeries= (cocName && cocName.length > 0) ? cocName.toString() : ""; let standards= standard.length > 0 ? standard.toString() : ""; let selectedProductFamilies = $('#standard').val(); $.ajax({ url: "maxManagement/product-family?cocSeries="+cocSeries, type: 'GET', success: function(res) { updateProductFamilyDropDown(res,selectedProductFamilies) showAndHide(); } }); } function getDropdownValues(dropdownId) { let values = []; $(`#${dropdownId} option`).each(function() { values.push($(this).val()); }); return values; } function updateProductFamilyDropDown(res,selectedProductFamilies){ var standards = document.getElementById("standard"); $("#standard option").remove(); $('#standard').multiselect('rebuild'); for (var i = 0; i < res.length; i++) { var option = document.createElement("option"); option.value = res[i]; option.innerText = res[i]; standards.appendChild(option); } $('#standard').val(selectedProductFamilies); $('#standard').multiselect('rebuild'); } function removeOptions(selectElement) { var i, L = selectElement.options.length - 1; for(i = L; i >= 0; i--) { selectElement.children[i].remove() } } function getIEXOrgProductFamily(standards){ $.ajax({ url: "portfolioManagement/iex-product-family", type: 'GET', success: function(res) { removeOptions(standards); for (var i = 0; i < res.length; i++) { var option = document.createElement("option"); option.value = res[i]; option.innertText = res[i]; standards.appendChild(option); } } }); } function getAllProductFamily(standards){ $.ajax({ url: "maxManagement/all-product-family", type: 'GET', success: function(res) { removeOptions(standards); for (var i = 0; i < res.length; i++) { var option = document.createElement("option"); option.value = res[i]; option.innertText = res[i]; standards.appendChild(option); } } }); } function enterKeyPressed(event) { if (event.keyCode == 13 && event.key === "Enter") { event.preventDefault(); document.getElementById("bensearch").click(); } } function ShowLeaveModel(){ var prevResponseArray = prevMaximumArray(); var currResponseArray = currMaximumArray(); if(_.isEqual(currResponseArray, prevResponseArray)){ $("#editVisitLimitModal").modal('hide'); }else{ $("#exampleModal").modal('show'); } } function closeUpdateModel(){ $("#exampleModal").modal('hide'); $("#editVisitLimitModal").modal('hide'); } var globalMaxID; function getMaxID(maxID){ globalMaxID = maxID; } function prevMaximumArray() { var prevResponseObj = {}; var editMaxId = document.getElementById("editMaximum_" + globalMaxID); if (editMaxId) { var prevArray = document.getElementById("editMaximum_" + globalMaxID).getAttribute('data-value'); const myArray = prevArray.split("^"); prevResponseObj['benCatName'] = myArray[0]; prevResponseObj['appliesTo'] = myArray[1]; prevResponseObj['crossApplies'] = myArray[2]; prevResponseObj['maxType'] = myArray[3]; prevResponseObj['maxValue'] = myArray[4]; prevResponseObj['freqType'] = myArray[5]; prevResponseObj['freqValue'] = myArray[6]; prevResponseObj['subCategory'] = myArray[8] || ""; prevResponseObj['visible'] = myArray[9]; prevResponseArray = JSON.stringify(prevResponseObj); return prevResponseArray; } } function currMaximumArray(){ var currResponseObj = {}; currResponseObj['benCatName'] = document.getElementById("visitlimit_bencat_Type").value; currResponseObj['subCategory'] = document.getElementById("visitlimit_subcategory").value || ""; currResponseObj['appliesTo'] = document.getElementById("visitlimit_limitApplies").value; currResponseObj['crossApplies'] = document.getElementById("visitlimit_limitCrossApplies").value; currResponseObj['maxType'] = document.getElementById("visitlimit_1_limitType").value; currResponseObj['maxValue'] = document.getElementById("visitlimit_1_limitValue").value; currResponseObj['freqType'] = document.getElementById("visitlimit_1_limitFreqType").value; currResponseObj['freqValue'] = document.getElementById("visitlimit_1_limitFreq").value; currResponseObj['visible'] = document.getElementById("visitlimit_visible").value; currResponseArray = JSON.stringify(currResponseObj); return currResponseArray; } function validateLimitValue(field) { if(validateNumeric(field)) { field.value=''; return false; } if(parseInt(field.value) < 1 || parseInt(field.value) > 999999) { field.value=''; return false; } if(parseInt(field.value) >= 1 || parseInt(field.value) <= 999999){ field.value = parseInt(field.value).toLocaleString('en-US'); } } function validateNumeric(number) { if (number.value != "") { if (number.value.includes('$')) { number.value = number.value.replace('$', ''); } if (number.value.includes(',')) { number.value = number.value.replace(',', ''); } //var numbers = /^[+]?[0-9]+$/; var numbers = /^[0-9]\d*(\.\d+)?$/; if (!number.value.match(numbers)) { number.value = ''; return true; } } } function resetIfInvalid(el){ if (el.value == "") { return; } if (!el.list || !el.list.options) { el.value = ""; return; } var options = el.list.options; for (var i = 0; i< options.length; i++) { if (el.value == options[i].value) { return; } } el.value = ""; } function getCloneIfpDropdowns(){ var standards = document.getElementById("clonestandards"); var cocSeries = $('#cloneCoc').val(); if(cocSeries !== "") { showAndHide(); $("#cloneStandard").val(""); $.ajax({ type: "POST", contentType: "application/json", url: "getIfpDropdowns", data: cocSeries, dataType: 'json', success: function(res) { removeOptions(standards); for (var i = 0; i < res.length; i++) { var option = document.createElement("option"); option.value = res[i]; option.innertText = res[i]; standards.appendChild(option); } showAndHide(); } }); } } function maximumBulkCascade(){ showAndHide(); var request = {}; request['cocSeries'] = $("#cocSeries").val(); request['state'] = $("#state").val(); request['standard'] = $("#standard").val(); $.ajax({ type: "POST", contentType: "application/json", url: "maximumBulkCascade", data: JSON.stringify(request), dataType: 'json', success: function (res) { if(res.batchID != null){ document.getElementById("successResult").innerHTML = 'Maximum Cascade Batch created with Batch ID : '+res.batchID; $("#sucessBoxNewMaximumModal").modal("toggle"); }else{ document.getElementById("errorMesssage").innerHTML = 'Batch creation Failed'; $("#errorModal").modal("toggle"); } showAndHide(); }, error: function (xhr) { console.log("error",xhr); alert("Something went wrong while saving plans, please try again..!"); } }); } function openChildMaximumModal(parentMaxId, benefitCategory, cocSeries, state, standard) { console.log("openChildMaximumModal - Parent:", parentMaxId, "BenCat:", benefitCategory, "COC:", cocSeries, "State:", state, "Standard:", standard); $("#isChildMaximum").val("true"); $("#parent_coc").val(cocSeries); $("#parent_state").val(state); $("#parent_productFamily").val(standard); $("#visitlimit_bencat_Type").val(benefitCategory); $("#parent_coc").prop('readonly', true); $("#parent_state").prop('readonly', true); $("#parent_productFamily").prop('readonly', true); $("#visitlimit_bencat_Type").prop('disabled', true); $("#maxId").val(""); $("#visitlimit_subcategory").val(""); $("#visitlimit_1_limitType").val(""); $("#visitlimit_1_limitValue").val(""); $("#visitlimit_1_limitFreq").val(""); $("#visitlimit_1_limitFreqType").val(""); $("#visitlimit_visible").val(""); $("#visitlimit_limitCrossApplies").val(""); $("#visitlimit_limitApplies").val(""); }

how i want the clone modal to look now similar code snippet for ui reference only
<div class="modal-body"> <div class="row"> <div class="col-6"> <div class="form-group"> <div class="form-floating"> <input type="text" class="form-control" data-key="" list="fromCOCs" name="fromCocSeries" id="fromCocSeries" placeholder="From COC Series"> <label for="fromCocSeries" class="form-label">From COC Series</label> <datalist id="fromCOCs"> <c:forEach var="coc" items="${cocSeries}"> <option id="${coc.cocSeries}">${coc.cocSeries}</option> </c:forEach> </datalist> </div> </div> </div> <div class="col-6"> <div class="form-group"> <div class="form-floating"> <input type="text" class="form-control" data-key="" list="toCOCs" name="toCocSeries" id="toCocSeries" placeholder="To COC Series"> <label for="toCocSeries" class="form-label">To COC Series</label> <datalist id="toCOCs"> <c:forEach var="coc" items="${cocSeries}"> <option id="${coc.cocSeries}">${coc.cocSeries}</option> </c:forEach> </datalist> </div> </div> </div> </div> </div>

rest clone functionality should remain unchanged
first the api needs to get all the bencats under "from" fields then clone then to the "to" fields combi now this is how the flow should be 
tell me what minimal code changes i need for this and where exactly i  need to make changes, go through all requirements and code above thoroughly
