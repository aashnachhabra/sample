<%@ page import="com.optum.ideate.mongodb.domain.BenefitCategory" %>
    <%@ page import="java.util.List" %>
        <%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>
            <%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
                <%@ taglib uri="http://java.sun.com/jsp/jstl/functions" prefix="fn" %>
                    <!doctype html>
                    <html>

                    <head>
                        <meta charset="utf-8">
                        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
                        <script src="https://code.jquery.com/jquery-3.5.1.js"
                            integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
                            crossorigin="anonymous"></script>
                        <link rel="stylesheet" href="css/UHCcustom.css">
                        <link rel="stylesheet" href="css/home.css">
                        <link rel="stylesheet" href="css/bootstrap.css">
                        <link rel="stylesheet" href="css/all.css">
                        <link rel="stylesheet" href="css/loader.css">

                        <script src="js/popper-1.14.3.min.js"></script>
                        <script src="js/datatables-1.11.5.min.js"></script>
                        <script src="js/datatables-1.11.4.bootstrap4.min.js"></script>
                        <script src="js/lodash-4.17.10.min.js"></script>
                        <script src="js/UHCcustom.js"></script>
                        <script src="js/bootstrap.min.js"></script>
                        <script src="js/bootstrap-popup.min.js"></script>
                        <script src="js/loader.js"></script>
                        <script src="js/jquery-3.5.1.js"></script>
                        <link rel="stylesheet" href="css/multislect-dropdown.css">
                        <script type="text/javascript" src="js/bootstrap-multiselect.js"></script>
                        <link rel="stylesheet" href="css/bootstrap-multiselect.css">
                        <script src="js/app/maximum-management.js"></script>

                        <title>Plan Library</title>
                        <link rel="icon" href="assets/PlanBuilderFavIcon.png">
                                                <style>
                            .table-striped tbody tr.highlight td {
                                background-color: #ff0000;
                            }

                            .table-striped tbody tr.highlight {
                                background-color: #ff0000;
                            }

                            .accordion-body .d-flex button {
                                flex: 1;
                            }

                            .accordion-header .form-check-input {
                                width: 16px;
                                height: 16px;
                                margin-left: 10px;
                                margin-right: 8px;
                                background-color: initial;
                                appearance: auto;
                                box-sizing: border-box;
                                padding: initial;
                                border: 2px solid #6c757d;
                                box-shadow: none;
                            }

                            .accordion-button:not(.collapsed) .selectable-accordion strong,
                            .accordion-button:not(.collapsed) .selectable-accordion small {
                                color: var(--bs-primary) !important;
                            }

                            .uhc-pager {
                                display: flex;
                                justify-content: center;
                                align-items: center;
                                user-select: none;
                            }

                            .uhc-pager-list {
                                display: inline-flex;
                                gap: 0;
                                padding: 0;
                                margin: 0;
                                list-style: none;
                                border: 1px solid #dcdcdc;
                                border-radius: 6px;
                                overflow: hidden;
                                background-color: #fff;
                            }

                            .uhc-pager-list>li {
                                display: inline-flex;
                            }

                            .uhc-pager-btn {
                                appearance: none;
                                border: none;
                                border-right: 1px solid #e6e6e6;
                                background: #fff;
                                color: #0d4a8b;
                                padding: 10px 16px;
                                font-size: 15px;
                                line-height: 1;
                                cursor: pointer;
                                min-width: 44px;
                                font-weight: 500;
                            }

                            .uhc-pager-list>li:last-child .uhc-pager-btn {
                                border-right: none;
                            }

                            .uhc-pager-btn:not(.is-active):not(:disabled):hover {
                                background-color: #f7f9fc;
                                color: #0a2e66;
                            }

                            .uhc-pager-btn.is-active {
                                background-color: #0a2e66;
                                color: #ffffff;
                                font-weight: 700;
                            }

                            .uhc-pager-btn:disabled {
                                color: #9aa0a6;
                                cursor: not-allowed;
                                background-color: #fff;
                            }

                            #pagerNumbers {
                                display: contents;
                            }

                            #pagerNumbers>li .uhc-pager-btn {
                                border-right: 1px solid #e6e6e6;
                            }

                            @media (max-width: 768px) {
                                .uhc-pager-list {
                                    flex-wrap: wrap;
                                }
                            }
                        </style>

                        <link href="js/frappe-datatable.min.css" rel="stylesheet">
                        <link rel="stylesheet" href="css/fontawesome.min.css">
                        <link rel="stylesheet" href="css/brands.min.css">
                        <link rel="stylesheet" href="css/solid.min.css">
                    </head>

                    <body>
                        <div id="main">
                            <%@include file="loader.jsp" %>
                                <%@include file="header.jsp" %>
                                    <div class="text-primary" style="margin: 2em;">
                                        <h1><i class="fa-solid fa-filter-circle-dollar"></i> Maximum Management</h1>
                                    </div>
                                    <div class="shadow-lg p-3 mb-5 bg-white rounded" style="margin:2em">
                                        <form action="./maxManagementSearch" id="bcfilters" method="post"
                                            autocomplete="off">
                                            <input type="hidden" id="ifpRoleId"
                                                value="${pageContext.session.getAttribute('ifpRoleId')}" />
                                            <input type="hidden" name="validateCoc" id="validateCoc" value="" />
                                            <div class="row">
                                                <c:if test="${enabledCascade == 'true'}">
                                                    <span class="modal-title text-danger">
                                                        <b>Warning: </b> There are benefit limit changes that have not
                                                        been cascaded to applicable plans. If you do not cascade these
                                                        updates, the applicable plans will not receive the changes. If
                                                        you leave this page the updates will be saved but not cascaded.
                                                    </span>
                                                </c:if>
                                            </div>
                                            </br>
                                            <div class="row">
                                                <div class="col">
                                                    <div class="form-floating">
                                                        <select id="cocSeries" name="coc" class="form-control"
                                                            multiple="multiple"
                                                            onchange="return validateSearch(true),onCocChange();">
                                                            <c:forEach var="coc" items="${maximumDD.cocSeriesMap}">
                                                                <c:set var="isSelected" value="false" />
                                                                <c:forEach var="selectedCoc"
                                                                    items="${fn:split(fn:escapeXml(maxManagementSearchRequest.coc != null ? maxManagementSearchRequest.coc : ''), ',')}">
                                                                    <c:if test="${fn:trim(selectedCoc) eq coc.key}">
                                                                        <c:set var="isSelected" value="true" />
                                                                    </c:if>
                                                                </c:forEach>
                                                                <option id="${coc.key}" value="${coc.key}" <c:if
                                                                    test="${isSelected}">selected</c:if>>${coc.value}
                                                                </option>
                                                            </c:forEach>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col">
                                                    <div class="form-floating">
                                                        <select id="state" name="stateName" class="form-control"
                                                            multiple="multiple" onchange="return validateSearch(true);">
                                                            <c:forEach var="state" items="${maximumDD.stateMap}">
                                                                <c:set var="isSelected" value="false" />
                                                                <c:forEach var="selectedState"
                                                                    items="${fn:split(fn:escapeXml(maxManagementSearchRequest.stateName != null ? maxManagementSearchRequest.stateName : ''), ',')}">
                                                                    <c:if test="${fn:trim(selectedState) eq state.key}">
                                                                        <c:set var="isSelected" value="true" />
                                                                    </c:if>
                                                                </c:forEach>
                                                                <option id="${state.key}" value="${state.key}" <c:if
                                                                    test="${isSelected}">selected</c:if>>${state.value}
                                                                </option>
                                                            </c:forEach>
                                                        </select>
                                                    </div>
                                                </div>

                                                <div class="col">
                                                    <div class="form-floating">
                                                        <select id="standard" name="standard" class="form-control"
                                                            multiple="multiple" onchange="return validateSearch(true);">
                                                            <c:forEach var="stand" items="${maximumDD.standardMap}">
                                                                <c:set var="isSelected" value="false" />
                                                                <c:forEach var="selectedStand"
                                                                    items="${fn:split(fn:escapeXml(maxManagementSearchRequest.standard != null ? maxManagementSearchRequest.standard : ''), ',')}">
                                                                    <c:if test="${fn:trim(selectedStand) eq stand.key}">
                                                                        <c:set var="isSelected" value="true" />
                                                                    </c:if>
                                                                </c:forEach>
                                                                <option id="${stand.key}" value="${stand.key}" <c:if
                                                                    test="${isSelected}">selected</c:if>>${stand.value}
                                                                </option>
                                                            </c:forEach>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>


                                            <div class="d-flex gap-2 w-100 mb-3 mt-3">

                                                <button type="button" class="btn btn-outline-warning btn-sm flex-fill"
                                                    title="Change Tracking" ${
                                                    (pageContext.session.getAttribute('ifpRoleId')==8 ||
                                                    pageContext.session.getAttribute('ifpRoleId')==9) ? "" : "disabled"
                                                    } onclick="window.open('./maxMgmtChangeSearch', '_blank');">
                                                    <i class="fas fa-exchange-alt"></i> Change Tracking
                                                </button>
                                                <button type="button" class="btn btn-outline-success btn-sm flex-fill" title="Export" onclick="exportMaximumManagement();">
                                                    <i class="fas fa-file-export"></i> Export
                                                </button>
                                                <button type="button" class="btn btn-outline-primary btn-sm flex-fill"
                                                        data-bs-toggle="modal" id="clone"
                                                        ${pageContext.session.getAttribute('ifpRoleId')==8 ? "" : "disabled"}
                                                        data-bs-target="#maxCloneModal">
                                                    <i class="fas fa-clone"></i>
                                                    Clone Year/State/Product
                                                </button>
                                                <button type="button" class="btn btn-outline-primary btn-sm flex-fill"
                                                    ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" :
                                                    (pageContext.session.getAttribute('ifpRoleId')==8 ||
                                                    pageContext.session.getAttribute('ifpRoleId')==9 ||
                                                    pageContext.session.getAttribute('roleId')==4 ?"":"disabled")}
                                                    id="newMaximum" data-bs-toggle="modal"
                                                    data-bs-target="#editVisitLimitModal">
                                                    <i class="fas fa-plus" style="font-size: 20px;"></i>
                                                    New Parent Maximum
                                                </button>
                                                <button type="button" class="btn btn-outline-primary btn-sm flex-fill"
                                                    id="bulkUpdate" data-bs-toggle="modal"
                                                    data-bs-target="#bulkUpdateModal" onclick="clearBulkUpdate()" disabled>
                                                    <i class="fas fa-clone"></i>
                                                    Bulk Update
                                                    <span id="bulkUpdateCount" class="ms-1 rounded border px-1 text-xs" style="display:none; background-color:#002677; color:#fff;">0</span>
                                                </button>
                                                <button type="button" class="btn btn-outline-warning btn-sm flex-fill"
                                                    id="clearMaxManagement"
                                                    ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" :
                                                    ((pageContext.session.getAttribute('roleId')!=7 &&
                                                    maxManagementSearchResponse.size()> 0)
                                                    ?"":"disabled")}
                                                    onclick="clearSearch();">
                                                    <i class="fas fa-eraser"></i>
                                                    Clear
                                                </button>

                                                <button type="submit" class="btn btn-outline-primary btn-sm flex-fill"
                                                    id="bensearch" ${ pageContext.session.getAttribute('roleId')!=7 &&
                                                    maxManagementSearchResponse.size()==0 ? "disabled" :""}
                                                    onclick="submitSearchForm();">
                                                    <i class="fas fa-search"></i> Search
                                                </button>
                                            </div>

                                        </form>
                                        <script type="text/javascript">
                                            showAndHide();
                                            (function () {
                                                setMultiSelectDropDown('#cocSeries', 'COC Series*');
                                                setMultiSelectDropDown('#state', 'State*');
                                                setMultiSelectDropDown('#standard', 'Product Family*');
                                            })();
                                        </script>

                                        <script type="text/javascript">
                                        var maxManagementSearchResponseVar = ${allMaxData};
                                        </script>
                                        <div>
                                            <div class="accordion w-100" id="maxAccordion" style="display: none;">
                                                <c:forEach var="groupEntry" items="${maxManagementSearchResponse}"
                                                    varStatus="groupLoop">
                                                    <c:set var="groupKey" value="${groupEntry.key}" />
                                                    <c:set var="groupItems" value="${groupEntry.value}" />
                                                    <c:set var="firstItem" value="${groupItems[0]}" />
                                                    <c:set var="subCount" value="${groupItems.size()}" />
                                                    <div class="accordion-item w-100 bt-1 acc-item"
                                                        data-acc-idx="${groupLoop.index}">
                                                        <h2 class="accordion-header" id="heading${groupLoop.index}">
                                                            <div class="d-flex align-items-center w-100">
                                                                <input type="checkbox" class="form-check-input me-2"
                                                                    id="selectRowChk_${groupLoop.index}"
                                                                    name="selectedRows" value="${firstItem.maxId}"
                                                                    onclick="toggleSelectRow(${groupLoop.index});">
                                                                <div class="accordion-button collapsed" type="button"
                                                                    data-bs-toggle="collapse"
                                                                    data-bs-target="#collapse${groupLoop.index}"
                                                                    aria-expanded="false"
                                                                    aria-controls="collapse${groupLoop.index}">
                                                                    <div class="d-flex w-100 justify-content-between align-items-center selectable-accordion m-2"
                                                                        id="accordionRow_${groupLoop.index}">
                                                                        <div class="d-flex align-items-center gap-2">
                                                                            <strong>${firstItem.benCatName}
                                                                                (${subCount})</strong>
                                                                            <small class="text-muted"> -
                                                                                ${firstItem.cocSeries} -

                                                                                ${firstItem.state} -
                                                                                ${firstItem.standard}</small>
                                                                        </div>
                                                                        <div></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </h2>
                                                        <div id="collapse${groupLoop.index}"
                                                            class="accordion-collapse collapse"
                                                            aria-labelledby="heading${groupLoop.index}">
                                                            <div class="accordion-body">
                                                                <div class="d-flex gap-2 mb-2">
                                                                    <button class="btn btn-outline-danger btn-sm"
                                                                        title="Delete Parent"
                                                                        ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                        ? "disabled" : "" }
                                                                        onclick="deleteParentMaximum('${firstItem.benCatName}', '${firstItem.cocSeries}', '${firstItem.state}', '${firstItem.standard}')">
                                                                        <i class="fas fa-trash"></i> Delete Parent

                                                                    <button class="btn btn-outline-primary btn-sm" title="Copy Parent & Children"
                                                                        onclick="openCopyParentChildModal('${firstItem.benCatName}', '${firstItem.cocSeries}', '${firstItem.state}', '${firstItem.standard}')">
                                                                        <i class="fas fa-copy"></i> Copy Parent &amp; Children
                                                                    </button>

                                                                   <button class="btn btn-outline-success btn-sm"
                                                                        title="Add Child Maximum"
                                                                        id="addChildMaximum_${groupLoop.index}"
                                                                        data-bs-toggle="modal"
                                                                        data-bs-target="#editVisitLimitModal"
                                                                        ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                        ? "disabled" :
                                                                        (pageContext.session.getAttribute('ifpRoleId')==8
                                                                        ||
                                                                        pageContext.session.getAttribute('ifpRoleId')==9
                                                                        || pageContext.session.getAttribute('roleId')==4
                                                                        ?"":"disabled")}
                                                                        onclick="openChildMaximumModal('${firstItem.maxId}', '${firstItem.benCatName}', '${firstItem.cocSeries}', '${firstItem.state}', '${firstItem.standard}');">
                                                                        <i class="far fa-plus"
                                                                            style="font-size: 20px;"></i> Add Child
                                                                        Maximum
                                                                    </button>
                                                                </div>
                                                                <input type="hidden" name="benefitCategoryName"
                                                                    id="benefitCategoryName_${groupLoop.index}"
                                                                    value="${firstItem.benCatName}">
                                                                <input type="hidden" name="row_${groupLoop.index}"
                                                                    id="row_${groupLoop.index}" value="0">
                                                                <input type="hidden" name="rescoc"
                                                                    id="rescoc_${groupLoop.index}"
                                                                    value="${firstItem.cocSeries}">
                                                                <input type="hidden" name="resstateName"
                                                                    id="resstateName_${groupLoop.index}"
                                                                    value="${firstItem.state}">
                                                                <input type="hidden" name="resstandard"
                                                                    id="resstandard_${groupLoop.index}"
                                                                    value="${firstItem.standard}">
                                                                <div class="table-responsive">
                                                                    <table class="table table-hover table-striped mb-0"
                                                                        id="newmaxtbl">
                                                                        <thead>
                                                                            <tr>
                                                                                <th scope="col">Sub Category</th>
                                                                                <th scope="col">Visible</th>
                                                                                <th scope="col">Applies To</th>
                                                                                <th scope="col">Cross Applies</th>
                                                                                <th scope="col">Max Type</th>
                                                                                <th scope="col">Max Value</th>
                                                                                <th scope="col">Freq. Type</th>
                                                                                <th scope="col">Freq. Value</th>
                                                                                <th scope="col">Action</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <c:forEach var="maximumData"
                                                                                items="${groupItems}"
                                                                                varStatus="itemLoop">
                                                                                <c:set var="loop"
                                                                                    value="${groupLoop.index}_${itemLoop.index}" />
                                                                                <tr>
                                                                                    <td>

                                                                                        ${maximumData.subCategory}
                                                                                        <input type="hidden"
                                                                                            name="subCategoryName_${loop}"
                                                                                            id="subCategoryName_${loop}"
                                                                                            value="${maximumData.subCategory}" />
                                                                                    </td>
                                                                                    <td>
                                                                                        <c:choose>
                                                                                            <c:when
                                                                                                test="${maximumData.visible == 'Yes'}">
                                                                                                <i class="fas fa-check-circle text-success"
                                                                                                    title="Visible"></i>
                                                                                            </c:when>
                                                                                            <c:when
                                                                                                test="${not empty maximumData.visible && maximumData.visible == 'No'}">
                                                                                                <i class="fas fa-times-circle text-danger"
                                                                                                    title="Not visible"></i>
                                                                                            </c:when>
                                                                                            <c:otherwise>
                                                                                            </c:otherwise>
                                                                                        </c:choose>
                                                                                        <input type="hidden"
                                                                                            id="visible_${loop}"
                                                                                            value="${maximumData.visible}">
                                                                                    </td>
                                                                                    <td>

                                                                                        ${maximumData.appliesTo}
                                                                                        <input type="hidden"
                                                                                            name="appliesTo"
                                                                                            id="appliesTo_${loop}"
                                                                                            value="${maximumData.appliesTo}">
                                                                                    </td>
                                                                                    <td>

                                                                                        ${maximumData.crossApplies}
                                                                                        <input type="hidden"
                                                                                            name="crossApplies"
                                                                                            id="crossApplies_${loop}"
                                                                                            value="${maximumData.crossApplies}">
                                                                                    </td>
                                                                                    <td>

                                                                                        ${maximumData.maxType}
                                                                                        <input type="hidden"
                                                                                            name="maxType"
                                                                                            id="maxType_${loop}"
                                                                                            value="${maximumData.maxType}">
                                                                                    </td>
                                                                                    <td>

                                                                                        ${maximumData.maxValue}
                                                                                        <input type="hidden"
                                                                                            name="maxValue"
                                                                                            id="maxValue_${loop}"
                                                                                            value="${maximumData.maxValue}">
                                                                                    </td>
                                                                                    <td>

                                                                                        ${maximumData.freqType}
                                                                                        <input type="hidden"
                                                                                            name="freqType"
                                                                                            id="freqType_${loop}"
                                                                                            value="${maximumData.freqType}">
                                                                                    </td>
                                                                                    <td>

                                                                                        ${maximumData.freqValue}
                                                                                        <input type="hidden"
                                                                                            name="freqValue"
                                                                                            id="freqValue_${loop}"
                                                                                            value="${maximumData.freqValue}">
                                                                                    </td>
                                                                                    <td>
                                                                                        <div class="btn-group btn-group-sm"
                                                                                            role="group">
                                                                                            <div class="btn-group">
                                                                                                <button
                                                                                                    class="btn btn-outline-primary"
                                                                                                    data-toggle="tooltip"
                                                                                                    data-placement="bottom"
                                                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                                                    ||
                                                                                                    pageContext.session.getAttribute('ifpRoleId')==8
                                                                                                    ||
                                                                                                    pageContext.session.getAttribute('ifpRoleId')==9
                                                                                                    ||
                                                                                                    pageContext.session.getAttribute('roleId')==4
                                                                                                    ?"":"disabled"}
                                                                                                    title="Edit"
                                                                                                    data-bs-toggle="modal"
                                                                                                    data-bs-target="#editVisitLimitModal"
                                                                                                    data-value="${maximumData.benCatName}^${maximumData.appliesTo}^${maximumData.crossApplies}^${maximumData.maxType}^${maximumData.maxValue}^${maximumData.freqType}^${maximumData.freqValue}^${maximumData.maxId}^${maximumData.subCategory}^${maximumData.visible}"
                                                                                                    id="editMaximum"
                                                                                                    onclick="getMaxID(${maximumData.maxId})">
                                                                                                    <i
                                                                                                        class="fas fa-edit"></i>
                                                                                                </button>
                                                                                                <input type="hidden"
                                                                                                    id="editMaximum_${maximumData.maxId}"
                                                                                                    data-value="${maximumData.benCatName}^${maximumData.appliesTo}^${maximumData.crossApplies}^${maximumData.maxType}^${maximumData.maxValue}^${maximumData.freqType}^${maximumData.freqValue}^${maximumData.maxId}^${maximumData.subCategory}^${maximumData.visible}">
                                                                                                <button
                                                                                                    class="btn btn-outline-danger"
                                                                                                    data-toggle="tooltip"
                                                                                                    data-placement="bottom"
                                                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                                                    ? "disabled" :
                                                                                                    (pageContext.session.getAttribute('ifpRoleId')==8
                                                                                                    ||
                                                                                                    pageContext.session.getAttribute('ifpRoleId')==9
                                                                                                    ||
                                                                                                    pageContext.session.getAttribute('roleId')==4
                                                                                                    ?"":"disabled")}
                                                                                                    title="Deactivate"
                                                                                                    data-bs-toggle="modal"
                                                                                                    id="deleteMaximum"
                                                                                                    onclick="deleteMaximum(${maximumData.maxId})">
                                                                                                    <i
                                                                                                        class="fas fa-trash"></i>
                                                                                                </button>
                                                                                            </div>
                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            </c:forEach>
                                                                        </tbody>
                                                                    </table>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </c:forEach>
                                                <div id="maxPager" class="uhc-pager"
                                                    style="display: none; margin: 1rem 2em;">
                                                    <nav aria-label="Accordion pagination">
                                                        <ul class="uhc-pager-list">
                                                            <li><button type="button" class="uhc-pager-btn"
                                                                    id="pagerFirst">First</button></li>
                                                            <li><button type="button" class="uhc-pager-btn"
                                                                    id="pagerPrev">Prev</button></li>
                                                            <span id="pagerNumbers"></span>

                                                            <li><button type="button" class="uhc-pager-btn"
                                                                    id="pagerNext">Next</button></li>
                                                            <li><button type="button" class="uhc-pager-btn"
                                                                    id="pagerLast">Last</button></li>
                                                        </ul>
                                                    </nav>
                                                </div>

                                                <c:if
                                                    test="${empty maxManagementSearchResponse || maxManagementSearchResponse.size() == 0}">
                                                    <div class="p-3">
                                                        <p>No maximums configured. Please add a new maximum to begin or
                                                            perform another search.</p>
                                                    </div>
                                                </c:if>
                                            </div>
                                        </div>
                                        <div class="modal fade" id="ErrorModal" tabindex="-1"
                                            aria-labelledby="ErrorModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5>
                                                            <span id="Close"
                                                                class="modal-title text-danger">Error</span>
                                                        </h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body"
                                                        style="overflow: auto; overflow-wrap: break-word; width: 30em; max-height: 20em;">
                                                        <p>
                                                            <span id="ErrorMesssage"></span>
                                                        </p>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <input type="submit" name="ErrorClose" value="Cancel"
                                                            id="ErrorClose" class="btn btn-outline-danger"
                                                            data-bs-dismiss="modal" autocomplete="off">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>


                                        <div class="modal fade" id="editVisitLimitModal">
                                            <div
                                                class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="editVisitLimitModalLabel"></h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            onclick="ShowLeaveModel()"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <form class="row g-3">
                                                            <input type="hidden" name="maxId" id="maxId" value="" />
                                                            <input type="hidden" name="isChildMaximum"
                                                                id="isChildMaximum" value="false" />

                                                            <!-- COC, State, Product Family fields - editable for parent, readonly for child -->
                                                            <div class="col-4">
                                                                <label for="parent_coc">COC Series<span
                                                                        style="color: red;">*</span></label>
                                                                <input type="text" class="form-control"
                                                                    list="parentCOCs" id="parent_coc" name="parent_coc"
                                                                    placeholder="COC Series"
                                                                    onchange="resetIfInvalid(this)"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }>
                                                                <datalist id="parentCOCs">
                                                                    <c:forEach var="coc"
                                                                        items="${maximumDD.cocSeriesMap}">
                                                                        <option value="${coc.value}">${coc.value}
                                                                        </option>
                                                                    </c:forEach>
                                                                </datalist>
                                                            </div>
                                                            <div class="col-4">
                                                                <label for="parent_state">State<span
                                                                        style="color: red;">*</span></label>
                                                                <input type="text" class="form-control"
                                                                    list="parentStates" id="parent_state"
                                                                    name="parent_state" placeholder="State"
                                                                    onchange="resetIfInvalid(this)"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }>
                                                                <datalist id="parentStates">
                                                                    <c:forEach var="state"
                                                                        items="${maximumDD.stateMap}">
                                                                        <option value="${state.value}">${state.value}
                                                                        </option>
                                                                    </c:forEach>
                                                                </datalist>
                                                            </div>
                                                            <div class="col-4">
                                                                <label for="parent_productFamily">Product Family<span
                                                                        style="color: red;">*</span></label>
                                                                <input type="text" class="form-control"
                                                                    list="parentStandards" id="parent_productFamily"
                                                                    name="parent_productFamily"
                                                                    placeholder="Product Family"
                                                                    onchange="resetIfInvalid(this)"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }>
                                                                <datalist id="parentStandards">
                                                                    <c:forEach var="stand"
                                                                        items="${maximumDD.standardMap}">
                                                                        <option value="${stand.value}">${stand.value}
                                                                        </option>
                                                                    </c:forEach>
                                                                </datalist>
                                                            </div>

                                                            <div class="visitlimit_benCat">
                                                                <label for="visitlimit_benCatType">Benefit Category<span
                                                                        style="color: red;">*</span></label>
                                                                <select id="visitlimit_bencat_Type"
                                                                    class="form-control adddvisitlimitbutaction"
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }
                                                                    title="Required - Select a Benefit Category type.">
                                                                    <option selected value="">Select...</option>
                                                                    <c:forEach var="benCat"
                                                                        items="${benefitCategoryNames}">
                                                                        <option id="${benCat}" name="${benCat}">
                                                                            ${benCat}</option>
                                                                    </c:forEach>
                                                                </select>
                                                            </div>
                                                            <div class="col-3">
                                                                <label for="visitlimit_1_limitType">Max Type</label>
                                                                <select id="visitlimit_1_limitType"
                                                                    class="form-control adddvisitlimitbutaction"
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }
                                                                    title="Required - Select a max type.">
                                                                    <option selected value="">Select...</option>
                                                                    <c:forEach var="limitType" items="${limitTypes}">
                                                                        <option id="${limitType}" name="${limitType}">
                                                                            ${limitType}
                                                                        </option>
                                                                    </c:forEach>
                                                                </select>
                                                            </div>
                                                            <div class="col-3">
                                                                <label for="visitlimit_1_limitValue">Max Value</label>
                                                                <input id="visitlimit_1_limitValue" type="text" min=1
                                                                    max=999999 oninput="validity.valid||(value='');"
                                                                    class="form-control adddvisitlimitbutaction"
                                                                    placeholder="" data-toggle="tooltip"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }
                                                                    onchange="validateLimitValue(this)"
                                                                    data-placement="top"
                                                                    title="Required - Enter a number greater than 1."></input>
                                                            </div>
                                                            <div class="col-3">
                                                                <label for="visitlimit_1_limitFreq">Frequency
                                                                    Value</label>
                                                                <input id="visitlimit_1_limitFreq" type="number" min=1
                                                                    max=9999 oninput="validity.valid||(value='');"
                                                                    class="form-control adddvisitlimitbutaction"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" } placeholder=""
                                                                    data-toggle="tooltip" data-placement="top"></input>
                                                            </div>
                                                            <div class="col-3">
                                                                <label for="visitlimit_1_limitFreqType">Frequency
                                                                    Type</label>
                                                                <select id="visitlimit_1_limitFreqType"
                                                                    class="form-control adddvisitlimitbutaction"
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }
                                                                    title="Required - Select Months, Years, or Lifetime.">
                                                                    <option selected value="">Select...</option>
                                                                    <c:forEach var="frequencyType"
                                                                        items="${frequencyTypes}">
                                                                        <option id="${frequencyType}"
                                                                            name="${frequencyType}">
                                                                            ${frequencyType}</option>
                                                                    </c:forEach>
                                                                </select>
                                                            </div>
                                                            <div class="dropdown-divider"></div>
                                                            <div class="form-group col-4">
                                                                <label for="visitlimit_limitCross_Applies"> Cross
                                                                    Applies</label>
                                                                <select id="visitlimit_limitCrossApplies"
                                                                    class="form-control adddvisitlimitbutaction"
                                                                    data-toggle="tooltip"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" } data-placement="top">
                                                                    <option selected value="">Select...</option>
                                                                    <c:forEach var="crossApply" items="${crossApplies}">
                                                                        <option id="${crossApply}" name="${crossApply}">
                                                                            ${crossApply}
                                                                        </option>
                                                                    </c:forEach>
                                                                </select>
                                                            </div>
                                                            <div class="form-group col-4">
                                                                <label for="visitlimit_limit_Applies">Applies To<span
                                                                        style="color: red;">*</span></label>
                                                                <select id="visitlimit_limitApplies"
                                                                    class="form-control " data-toggle="tooltip"
                                                                    data-placement="top"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }
                                                                    title="Required - Select applies to this limit.">
                                                                    <option selected value=" ">Select...</option>
                                                                    <c:forEach var="applies" items="${appliesTo}">
                                                                        <option id="${applies}" name="${applies}">
                                                                            ${applies}</option>
                                                                    </c:forEach>
                                                                </select>
                                                            </div>
                                                            <div class="form-group col-4">
                                                                <label for="visitlimit_visible">Visible<span
                                                                        style="color: red;">*</span></label>
                                                                <select id="visitlimit_visible"
                                                                    class="form-control adddvisitlimitbutaction"
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }
                                                                    title="Required - Select Yes or No.">
                                                                    <option selected value="">Select...</option>
                                                                    <c:forEach var="visibleOption" items="${visible}">
                                                                        <option id="${visibleOption}"
                                                                            name="${visibleOption}">
                                                                            ${visibleOption}</option>
                                                                    </c:forEach>
                                                                </select>
                                                            </div>
                                                            <div class="visitlimit_subcategory">
                                                                <label for="visitlimit_subcategory">Sub Category</label>
                                                                <input type="text" id="visitlimit_subcategory"
                                                                    class="form-control"
                                                                    readonly
                                                                    data-toggle="tooltip" data-placement="top"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" : "" }
                                                                    title="Auto-populated based on Applies To selection"
                                                                    placeholder="Auto-populated based on Applies To">
                                                            </div>
                                                            <div class="dropdown-divider"></div>
                                                            <div class="col-2">
                                                                <div class="d-grid gap-2">
                                                                    <button type="button"
                                                                        class="btn btn-block btn-outline-danger"
                                                                        data-bs-dismiss="modal"
                                                                        onclick="ShowLeaveModel()">
                                                                        Cancel
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <div class="col-2">
                                                                <div class="d-grid gap-2">
                                                                    <button type="button"
                                                                        class="btn btn-block btn-outline-warning"
                                                                        ${pageContext.session.getAttribute("ifpRoleId")==10
                                                                        ? "disabled" : "" }
                                                                        id="editVisitLimitModalClearBut">Clear
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <div class="delete-maximum col-2">
                                                                <div class="d-grid gap-2">
                                                                    <button type="button"
                                                                        class="btn btn-block btn-outline-danger"
                                                                        data-toggle="modal"
                                                                        data-target="#deltevisitlimitConf"
                                                                        id="editVisitLimitModalDeleteBut"
                                                                        ${pageContext.session.getAttribute("ifpRoleId")==10
                                                                        ? "disabled" : "" }
                                                                        onclick="deleteMaximumFromEdit();">Delete
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            <div class="col-2">
                                                                <div class="d-grid gap-2">
                                                                    <button type="button"
                                                                        class="btn btn-block btn-outline-primary"
                                                                        id="editVisitLimitModalSaveBut"
                                                                        ${pageContext.session.getAttribute("ifpRoleId")==10
                                                                        ? "disabled" : "" }
                                                                        onclick="validateCoc('maxSave')" disabled>Save
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="modal fade" id="sucessBoxNewMaximumModal" tabindex="-1"
                                            role="dialog" aria-labelledby="sucessBoxNewMaximumModalLabel"
                                            aria-hidden="true" data-bs-backdrop='static'>
                                            <div class="modal-dialog modal-dialog-centered" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5><span id="lblWarnTitle" class="modal-title text-success">
                                                                Success </span>
                                                        </h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            aria-label="Close" onclick="reloadSearch();"></button>
                                                    </div>
                                                    <div class="modal-body" id="successResult">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="modal fade" id="errorModal" tabindex="-1"
                                            aria-labelledby="errorModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5><span id="ErrorClose"
                                                                class="modal-title text-danger">Error</span></h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            aria-label="Close" onclick="reloadSearch();"></button>
                                                    </div>
                                                    <div class="modal-body" id="errorMesssage"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal fade" id="deleteParentConfirmBoxModal" tabindex="-1"
                                            role="dialog" aria-labelledby="deleteParentConfirmBoxModal"
                                            aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered" role="document">
                                                <div class="modal-content">

                                                    <div class="modal-header">
                                                        <h5><span id="lblParentWarnTitle"
                                                                class="modal-title text-danger"> Warning
                                                            </span></h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <input type="hidden" name="benCatName" id="benCatNameDelete"
                                                            value="" />
                                                        <input type="hidden" name="cocSeries" id="cocSeriesDelete" value="" />
                                                        <input type="hidden" name="state" id="stateDelete" value="" />
                                                        <input type="hidden" name="standard" id="standardDelete" value="" />
                                                        Please confirm that you'd like to delete this selected parent
                                                        plan?
                                                    </div>
                                                    <div class="modal-footer">
                                                        <input type="submit" value="Cancel" id="deleteParentClose"
                                                            class="btn btn-outline-danger" data-bs-dismiss="modal"
                                                            autocomplete="off">
                                                        <a onclick="deleteParentMaximumConfirm()"
                                                            id="deleteParentConfirmVal" class="btn btn-outline-success"
                                                            data-dismiss="modal">Confirm</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal fade" id="deleteConfirmBoxModal" tabindex="-1" role="dialog"
                                            aria-labelledby="deleteConfirmBoxModal" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered" role="document">
                                                <div class="modal-content">

                                                    <div class="modal-header">
                                                        <h5><span id="lblWarnTitle" class="modal-title text-danger">
                                                                Warning </span>
                                                        </h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <input type="hidden" name="maxIdVal" id="maxIdVal" value="" />
                                                        Please confirm that you'd like to delete this selected plan?
                                                    </div>
                                                    <div class="modal-footer">
                                                        <input type="submit" value="Cancel" id="deleteClose"
                                                            class="btn btn-outline-danger" data-bs-dismiss="modal"
                                                            autocomplete="off">
                                                        <a onclick="deleteMaximumData()" id="deleteConfirmVal"
                                                            class="btn btn-outline-success"
                                                            data-dismiss="modal">Confirm</a>

                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Clone Modal -->
                                        <div class="modal fade" id="maxCloneModal" tabindex="-1"
                                            aria-labelledby="maxCloneModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-dialog-centered">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="maxCloneModalLabel">Clone New
                                                            Maximum Configuration
                                                        </h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                            aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <input type="hidden" name="cloneBenefitCategoryName"
                                                            id="cloneBenefitCategoryName">
                                                        <div class="row g-2 mb-2 align-items-center">
                                                            <div class="col-6">
                                                                <div class="form-floating">
                                                                    <select class="form-control" id="fromCocSeries"
                                                                        name="fromCocSeries"
                                                                        onchange="enableClone(this);">
                                                                        <option value="">Select From COC Series</option>
                                                                        <c:forEach var="coc"
                                                                            items="${maximumDD.cocSeriesMap}">
                                                                            <option value="${coc.key}">${coc.value}
                                                                            </option>
                                                                        </c:forEach>
                                                                    </select>
                                                                    <label for="fromCocSeries">From COC Series</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-6">
                                                                <div class="form-floating">
                                                                    <select class="form-control" id="toCocSeries"
                                                                        name="toCocSeries"
                                                                        onchange="enableClone(this);">
                                                                        <option value="">Select To COC Series</option>
                                                                        <c:forEach var="coc"
                                                                            items="${maximumDD.cocSeriesMap}">
                                                                            <option value="${coc.key}">${coc.value}
                                                                            </option>
                                                                        </c:forEach>
                                                                    </select>
                                                                    <label for="toCocSeries">To COC Series</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row g-2 mb-2 align-items-center">
                                                            <div class="col-6">
                                                                <div class="form-floating">
                                                                    <select class="form-control" id="fromState"
                                                                        name="fromState" onchange="enableClone(this);">
                                                                        <option value="">Select From State</option>
                                                                        <c:forEach var="state"
                                                                            items="${maximumDD.stateMap}">
                                                                            <option value="${state.key}">${state.value}
                                                                            </option>
                                                                        </c:forEach>
                                                                    </select>
                                                                    <label for="fromState">From State</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-6">
                                                                <div class="form-floating">
                                                                    <select class="form-control" id="toState"
                                                                        name="toState" onchange="enableClone(this);">
                                                                        <option value="">Select To State</option>
                                                                        <c:forEach var="state"
                                                                            items="${maximumDD.stateMap}">
                                                                            <option value="${state.key}">${state.value}
                                                                            </option>
                                                                        </c:forEach>
                                                                    </select>
                                                                    <label for="toState">To State</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row g-2 mb-2 align-items-center">
                                                            <div class="col-6">
                                                                <div class="form-floating">
                                                                    <select class="form-control" id="fromStandard"
                                                                        name="fromStandard"
                                                                        onchange="enableClone(this);">
                                                                        <option value="">Select From Product Family
                                                                        </option>
                                                                        <c:forEach var="stand"
                                                                            items="${maximumDD.standardMap}">
                                                                            <option value="${stand.key}">${stand.value}
                                                                            </option>
                                                                        </c:forEach>
                                                                    </select>
                                                                    <label for="fromStandard">From Product
                                                                        Family</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-6">
                                                                <div class="form-floating">
                                                                    <select class="form-control" id="toStandard"
                                                                        name="toStandard" onchange="enableClone(this);">
                                                                        <option value="">Select To Product Family
                                                                        </option>
                                                                        <c:forEach var="stand"
                                                                            items="${maximumDD.standardMap}">
                                                                            <option value="${stand.key}">${stand.value}
                                                                            </option>
                                                                        </c:forEach>
                                                                    </select>
                                                                    <label for="toStandard">To Product Family</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-warning"
                                                            data-bs-dismiss="modal">Cancel</button>
                                                        <button type="button" class="btn btn-success" disabled=""
                                                            id="clonebtn" onclick="startClone();">Clone</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Modal -->
                                        <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="exampleModalLabel">Leave site?</h5>
                                                        <button type="button" class="close" data-bs-dismiss="modal"
                                                            aria-label="Close"><span
                                                                aria-hidden="true">&times;</span></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        Changes you made may not be saved.
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-secondary"
                                                            data-bs-dismiss="modal"
                                                            onclick="closeUpdateModel()">Leave</button>
                                                        <button type="button" class="btn btn-primary"
                                                            data-bs-dismiss="modal">Cancel</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div style="position: fixed; top: 1%; right: 40%; z-index: 1;" class="toast"
                                            data-autohide="false" id="success">
                                            <div class="toast-header">
                                                <strong class="mr-auto text-primary"> <i class="fas fa-square"
                                                        style="color: #00a550"></i>Success
                                                </strong>
                                                <button type="button" style="margin-left: 13rem;" class="btn-close"
                                                    data-bs-dismiss="toast"></button>
                                            </div>
                                            <div class="toast-body" style="background-color: #E8E8E8"
                                                id="successMessage"></div>
                                        </div>
                                        <div class="modal fade" id="cascadeLeaveModal" tabindex="-1" role="dialog"
                                            aria-labelledby="cascadeLeaveModalLabel" aria-hidden="true">
                                            <div class="modal-dialog" role="document">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title" id="cascadeLeaveLabel">Leave site?</h5>
                                                        <button type="button" class="close" data-bs-dismiss="modal"
                                                            aria-label="Close"><span
                                                                aria-hidden="true">&times;</span></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        Warning: there are benefit limit changes that have not been
                                                        cascaded to
                                                        applicable plans. If you do not cascade these updates, the
                                                        applicable plans will
                                                        not receive the changes. If you leave this page the updates will
                                                        be saved but
                                                        not cascaded.
                                                    </div>
                                                    <div class="modal-footer">
                                                        <a type="button" class="btn btn-secondary"
                                                            data-bs-dismiss="modal"
                                                            href="${pageContext.session.getAttribute('planlibraryUrl')}">Leave</a>
                                                        <button type="button" class="btn btn-primary"
                                                            data-bs-dismiss="modal"
                                                            onclick="restricBrowserClose()">Cancel</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal fade" id="bulkUpdateModal">
                                            <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
                                                <div class="modal-content">
                                                    <div class="modal-header mb-2 flex justify-between items-center">
                                                        <h5 class="modal-title" id="bulkUpdateModalLabel">Bulk Update</h5>
                                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                    </div>
                                                    <div class="modal-body">
                                                        <p class="mb-4 text-sm text-muted">For the<span id="selectedCount" class="ms-1 text-muted"></span>, apply the following values (up to 4):</p>
                                                        <div class="space-y-3">
                                                            <c:forEach var="i" begin="1" end="4">
                                                                <div class="row mb-2">
                                                                    <div class="col-md-6">
                                                                        <label class="form-label text-xs text-muted">Field</label>
                                                                        <select id="bulkField_${i}" class="form-control"
                                                                            onchange="handleBulkFieldChange(this, 'bulkValueInput_${i}')">
                                                                            <option value="">Choose Field...</option>
                                                                            <option value="Visible">Visible</option>
                                                                            <option value="Cross Applies">Cross Applies</option>
                                                                            <option value="Max Type">Max Type</option>
                                                                            <option value="Max Value">Max Value</option>
                                                                            <option value="Freq Type">Freq Type</option>
                                                                            <option value="Freq Value">Freq Value</option>
                                                                        </select>
                                                                    </div>
                                                                    <div class="col-md-6">
                                                                        <label class="form-label text-xs text-muted">Value</label>
                                                                        <span id="bulkValueInput_${i}">
                                                                            <input class="form-control" type="text" disabled>
                                                                        </span>
                                                                    </div>
                                                                </div>
                                                            </c:forEach>
                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-block btn-outline-danger" data-bs-dismiss="modal">Cancel</button>
                                                        <button type="button" id="applyBulkUpdate" class="btn btn-block btn-outline-primary"
                                                            data-bs-dismiss="modal" onclick="applyBulkUpdate()" disabled>Apply</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <%@include file="footer.html" %>
                        </div>
                        <script>
                            (function () {
                                const PAGE_SIZE = 50;
                                const WINDOW_SIZE = 20;

                                const accordion = document.getElementById('maxAccordion');
                                if (!accordion) return;
                                const items = Array.from(accordion.querySelectorAll('.acc-item'));
                                const pager = document.getElementById('maxPager');
                                const btnFirst = document.getElementById('pagerFirst');
                                const btnPrev = document.getElementById('pagerPrev');
                                const btnNext = document.getElementById('pagerNext');
                                const btnLast = document.getElementById('pagerLast');
                                const numbersMount = document.getElementById('pagerNumbers');

                                if (items.length === 0) {
                                    if (pager) pager.style.display = 'none';
                                    return;
                                }

                                const totalItems = items.length;
                                const totalPages = Math.ceil(totalItems / PAGE_SIZE);
                                let currentPage = 1;

                                function showPage(page) {
                                    currentPage = Math.max(1, Math.min(totalPages, page));
                                    items.forEach(el => { el.style.display = 'none'; });
                                    const startIdx = (currentPage - 1) * PAGE_SIZE;
                                    const endIdx = Math.min(startIdx + PAGE_SIZE, totalItems);
                                    for (let i = startIdx; i < endIdx; i++) {
                                        items[i].style.display = '';
                                    }
                                    renderWindowNumbers();
                                    updateEdgeButtons();
                                    pager.style.display = (totalPages > 1) ? 'flex' : 'none';
                                }

                                function updateEdgeButtons() {
                                    const atFirst = currentPage === 1;
                                    const atLast = currentPage === totalPages;
                                    btnFirst.disabled = atFirst;
                                    btnPrev.disabled = atFirst;
                                    btnNext.disabled = atLast;
                                    btnLast.disabled = atLast;
                                }
                                function renderWindowNumbers() {
                                    numbersMount.innerHTML = '';

                                    if (totalPages <= WINDOW_SIZE) {
                                        for (let p = 1; p <= totalPages; p++) appendPageBtn(p);
                                        return;
                                    }

                                    const half = Math.floor(WINDOW_SIZE / 2);
                                    let start = currentPage - half;
                                    let end = currentPage + half;
                                    if (WINDOW_SIZE % 2 === 0) end = currentPage + half - 1;
                                    if (start < 1) {
                                        end += (1 - start);
                                        start = 1;
                                    }
                                    if (end > totalPages) {
                                        const overshoot = end - totalPages;
                                        start = Math.max(1, start - overshoot);
                                        end = totalPages;
                                    }
                                    const visibleCount = end - start + 1;
                                    if (visibleCount < WINDOW_SIZE) {
                                        const deficit = WINDOW_SIZE - visibleCount;
                                        end = Math.min(totalPages, end + deficit);
                                        start = Math.max(1, end - WINDOW_SIZE + 1);
                                    }

                                    for (let p = start; p <= end; p++) appendPageBtn(p);
                                }

                                function appendPageBtn(p) {
                                    const li = document.createElement('li');
                                    const btn = document.createElement('button');
                                    btn.type = 'button';
                                    btn.className = 'uhc-pager-btn' + (p === currentPage ? ' is-active' : '');
                                    btn.textContent = String(p);
                                    btn.setAttribute('aria-label', `Go to page ${p}`);
                                    btn.disabled = (p === currentPage);
                                    btn.addEventListener('click', function () {
                                        if (!btn.disabled) showPage(p);
                                    });
                                    li.appendChild(btn);
                                    numbersMount.appendChild(li);
                                }
                                btnFirst.addEventListener('click', () => showPage(1));
                                btnPrev.addEventListener('click', () => showPage(currentPage - 1));
                                btnNext.addEventListener('click', () => showPage(currentPage + 1));
                                btnLast.addEventListener('click', () => showPage(totalPages));
                                showPage(1);
                                window.__maxAccordionPaginate = function () {
                                    const freshItems = Array.from(accordion.querySelectorAll('.acc-item'));
                                    items.length = 0;
                                    Array.prototype.push.apply(items, freshItems);
                                    currentPage = 1;
                                    showPage(1);
                                };
                            })();

                            const BULK_OPTIONS = {
                                visible: [
                                    <c:forEach var="v" items="${visible}" varStatus="s">
                                       "${v}"<c:if test="${!s.last}">,</c:if>
                                    </c:forEach>
                                         ],
                                crossApplies: [
                                    <c:forEach var="c" items="${crossApplies}" varStatus="s">
                                        "${c}"<c:if test="${!s.last}">,</c:if>
                                    </c:forEach>
                                              ],
                                maxTypes: [
                                    <c:forEach var="m" items="${limitTypes}" varStatus="s">
                                        "${m}"<c:if test="${!s.last}">,</c:if>
                                    </c:forEach>
                                          ],
                                freqTypes: [
                                    <c:forEach var="f" items="${frequencyTypes}" varStatus="s">
                                        "${f}"<c:if test="${!s.last}">,</c:if>
                                    </c:forEach>
                                           ]};
                        </script>
                    </body>

                   <!-- Copy Parent & Child Modal-->
                        <div class="modal fade" id="copyParentChildModal" tabindex="-1" aria-labelledby="copyParentChildModalLabel" aria-hidden="true">
                          <div class="modal-dialog modal-lg modal-dialog-centered">
                            <div class="modal-content">
                              <div class="modal-header">
                                <h5 class="modal-title" id="copyParentChildModalLabel">Copy Parent & Child</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                              </div>
                              <div class="modal-body">
                                <form id="copyParentChildForm">
                                  <div class="row">
                                    <!-- From Section -->
                                    <div class="col-md-6">
                                      <label class="form-label">From</label>
                                      <input type="text" class="form-control mb-1" id="fromBenefitCategory" readonly>
                                      <input type="text" class="form-control mb-1" id="fromCoc" readonly>
                                      <input type="text" class="form-control mb-1" id="fromStateCopy" readonly>
                                     <input type="text" class="form-control mb-1" id="fromProductFamily" readonly>
                                    </div>
                                    <!-- To Section -->
                                    <div class="col-md-6">
                                      <label class="form-label">To</label>
                                      <input type="text" class="form-control mb-1" id="toBenefitCategory" readonly>
                                      <!-- COC Series Dropdown -->
                                      <select class="form-control mb-1" id="toCoc" name="toCoc">
                                        <option value="">Select COC Series</option>
                                        <c:forEach var="coc" items="${maximumDD.cocSeriesMap}">
                                          <option value="${coc.value}">${coc.value}</option>
                                        </c:forEach>
                                      </select>
                                      <!-- State Dropdown -->
                                      <select class="form-control mb-1" id="toStateCopy" name="toState">
                                        <option value="">Select State</option>
                                        <c:forEach var="state" items="${maximumDD.stateMap}">
                                          <option value="${state.value}">${state.value}</option>
                                        </c:forEach>
                                      </select>
                                      <!-- Product Family Dropdown -->
                                      <select class="form-control mb-1" id="toProductFamily" name="toProductFamily">
                                        <option value="">Select Product Family</option>
                                        <c:forEach var="stand" items="${maximumDD.standardMap}">
                                          <option value="${stand.value}">${stand.value}</option>
                                        </c:forEach>
                                      </select>
                                    </div>
                                  </div>
                                </form>
                              </div>
                              <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                <button type="button" class="btn btn-primary" id="copyParentChildSubmit">Copy</button>
                              </div>
                            </div>
                          </div>
                        </div>
                    </body>

                    </html>
in this for every accordion i want a notes button (with same blue white theme as other buttons and a suitable pencil type icon), it should open a modal and not trigger accordion to open or close, accordion open close should work as it is
tell me code change what to do and exactly where
