@app.route('/uploadDoc/dbs', methods=['POST'])
def uploadDoc_dbs():
    file = request.files.get('file')
    if not file or file.filename == '':
        logger.warning("No valid file provided in DBS upload")
        return jsonify({"error": "No valid file provided"}), 400

    filename = secure_filename(file.filename)
    file_path = os.path.join(app.config['UPLOAD_DBS_FOLDER'], filename)
    file.save(file_path)
    logger.info(f"DBS file uploaded to: {file_path}")

    timestamp = datetime.now().strftime("%Y-%m-%d_%H-%M-%S")
    base_filename = os.path.splitext(filename)[0]
    dbs_json_path = os.path.join(app.config['OUTPUT_JSON_DBS_FOLDER'], f"{base_filename}_{timestamp}_dbs.json")

    try:
        result = process_pdf_to_json(file_path, dbs_json_path)
        if "error" in result:
            logger.error(f"Error processing DBS file: {result['error']}")
            return jsonify(result), 400

        logger.info(f"DBS file processed successfully: {dbs_json_path}")
        return jsonify({"extracted_json": result, "file_path": f"{base_filename}_{timestamp}_dbs.json"}), 200
    except Exception as e:
        logger.error(f"Unexpected error occurred during DBS processing: {e}")
        return jsonify({"error": "Unexpected error occurred during DBS processing"}), 500
