
      - name: Fetch Changed Files
        id: changed-files
        run: |
          # Get the PR number
          PR_NUMBER="${{ github.event.pull_request.number }}"

          # Get the list of changed files for the PR
          FILES=$(gh pr view $PR_NUMBER --json files --jq '.files[] | {path: .path, status: .changeType}')

          # Verify FILES contains the expected data
          echo "FILES: $FILES"

          # Construct the absolute paths with file status
          REPO_URL="https://github.com/uhc-tech-employer-individual/altus_genie/blob/main"
          ABSOLUTE_PATHS=$(echo "$FILES" | jq -c --arg REPO_URL "$REPO_URL" '[{path: ($REPO_URL + "/" + .path), status: .status}]')

          # Output the list of absolute file paths with their status
          echo "${ABSOLUTE_PATHS}" > changed_files.json
          echo "::set-output name=files::${ABSOLUTE_PATHS}"

          # Debug output
          echo "Changed files JSON:"
          cat changed_files.json
