import React, { useEffect, useState } from "react";
import { useLocation } from "react-router-dom";
import * as XLSX from "xlsx";
import Spreadsheet from "react-spreadsheet";
import "./ExcelViewer.css"; // Import your CSS file for custom styles

function ExcelViewer() {
  const location = useLocation();
  const [spreadsheetData, setSpreadsheetData] = useState([]);
  const [downloadUrl, setDownloadUrl] = useState("");

  useEffect(() => {
    if (!location.state?.fileURL) return;
    const fetchExcel = async () => {
      const res = await fetch(location.state.fileURL);
      const blob = await res.blob();
      setDownloadUrl(location.state.fileURL);
      const reader = new FileReader();
      reader.onload = (e) => {
        const workbook = XLSX.read(e.target.result, { type: "binary" });
        const worksheet = workbook.Sheets[workbook.SheetNames[0]];
        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
        const formattedData = jsonData.map((row, rowIndex) =>
          row.map((cell) => ({
            value: cell,
            readOnly: rowIndex === 0, // Make the first row read-only
            className: rowIndex === 0 ? "header-cell" : "", // Add class to the first row
          }))
        );
        setSpreadsheetData(formattedData);
      };
      reader.readAsBinaryString(blob);
    };
    fetchExcel();
  }, [location]);

  return (
    <div className="p-6 bg-gray-100 min-h-[calc(100vh-64px)]">
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-2xl font-semibold text-blue-900">Evaluation Results</h2>
        {downloadUrl && (
          <a
            href={downloadUrl}
            download="deepeval_results.xlsx"
            className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-md font-semibold transition"
          >
            Download
          </a>
        )}
      </div>
      <div className="bg-white p-4 rounded-md shadow overflow-auto">
        {spreadsheetData.length > 0 ? (
          <Spreadsheet data={spreadsheetData} />
        ) : (
          <p className="text-gray-600 text-center">Loading spreadsheet...</p>
        )}
      </div>
    </div>
  );
}

export default ExcelViewer;

can u also fix this ui of excel and add icons where you may need to. Make the excel more user friendly the columns are too wide they should nbe appropriately set and make the ui more better and crisp yet profrssional and should be according to uhg standards and do not affect logic just ui
