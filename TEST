    @GetMapping("/maxManagement")
    public ModelAndView maximumManagement(ModelAndView modelAndView, HttpServletRequest request) {
        try {
            modelAndView.setViewName("MaximumManagement");
            MaximumMgmtDDMapResponse maximumMgmtDDMapResponse;
            MaximumMgmtDDMapResponse maximumMgmtDDMapResponseForIEX;
            HttpSession session = request.getSession();
            maximumMgmtDDMapResponse = maximumManagementService.getMaximumMgmtDropDownsMap();
            maximumMgmtDDMapResponseForIEX = maximumManagementService.getMaximumMgmtDropDownsForIEXOrg();
            maximumMgmtDDMapResponse.getStandardMap().clear();
            maximumMgmtDDMapResponse.getStandardMap().putAll(maximumMgmtDDMapResponseForIEX.getStandardMap());
            session.setAttribute("maximumMngDDMap", maximumMgmtDDMapResponse);
            modelAndView.addObject("maximumDD", maximumMgmtDDMapResponse);
            List<MaximumManagementCollection> allMaxData = maximumManagementService.getAllMaxManagementData();
            modelAndView.addObject("maxManagementSearchResponse", allMaxData);

            modelAndView.addObject("maxManagementSearchRequest", null);
            session.setAttribute("maxManagementSearchRequest", null);

            // Populate all dropdowns same as in maxManagementSearch
            List<MasterBenefitCategoryCollection> benefitCategoryList = productManagmentService.getMasterBenefitCategoryCollection();
            List<String> benefitCategoryNames = new ArrayList<>();
            if (CollectionUtils.isNotEmpty(benefitCategoryList)) {
                benefitCategoryList.stream().forEach(bcl -> benefitCategoryNames.add(bcl.getBenefitCategoryValue()));
            }
            benefitCategoryNames.sort(Comparator.naturalOrder());
            modelAndView.addObject(Constants.BEN_CAT_NAMES, benefitCategoryNames);

            // Use default values since no specific COC is selected yet
            List<String> limitTypes = Constants.limitType;
            List<String> frequencyTypes = Constants.frequencyType;
            List<String> appliesTo = Constants.appliesTo;

            limitTypes.remove(" ");
            modelAndView.addObject(Constants.LIMIT_TYPES, limitTypes);
            frequencyTypes.remove(" ");
            modelAndView.addObject(Constants.FREQUENCY_TYPES, frequencyTypes);
            appliesTo.remove(" ");
            appliesTo.sort(Comparator.naturalOrder());
            modelAndView.addObject(Constants.APPLIES_TO, appliesTo);

            List<String> crossApplies = Constants.crossApplies;
            crossApplies.remove(" ");
            modelAndView.addObject(Constants.CROSS_APPLIES, crossApplies);

            List<String> visible = Constants.visible;
            visible.remove(" ");
            modelAndView.addObject(Constants.VISIBLE, visible);

            List<String> subCategory = Constants.subCategory;
            modelAndView.addObject(Constants.SUBCATEGORY, subCategory);

            return modelAndView;
        } catch (Exception exception) {
            return ErrorUtil.validateErrorMessage(exception);
        }
    }


    @Override
    public List<MaximumManagementCollection> getAllMaxManagementData() {
        List<MaximumManagementCollection> maxList = new ArrayList<>();
        try {
            maxList = maxRepository.findAll();
            maxList = maxList.stream()
                    .filter(e -> Constants.active.equals(e.getStatus()))
                    .sorted(Comparator
                            .comparing((MaximumManagementCollection m) -> safeString(m.getBenCatName()))
                            .thenComparing(m -> safeString(String.valueOf(m.getCocSeries())))
                            .thenComparing(m -> safeString(m.getState()))
                            .thenComparing(m -> safeString(m.getStandard()))
                    )
                    .collect(Collectors.toList());
        } catch (Exception e) {
            logger.error("Error fetching all MaximumManagement data: " + e.getMessage());
        }
        return maxList;
    }

    private String safeString(String s) {
        return s == null ? "" : s.trim().toLowerCase();
    }

[
    {
        "id": "663b365ba8a71641890ace7d",
        "maxId": 978,
        "benCatName": "Abortion",
        "cocSeries": 2024,
        "state": "FL",
        "standard": "Advantage+",
        "appliesTo": "Basic-Major",
        "crossApplies": "Yes",
        "maxType": "Dollar Limit",
        "maxValue": "11",
        "freqType": "Day(s)",
        "freqValue": 21,
        "status": "Active",
        "visible": "Yes",
        "subCategory": "",
        "isBulkCascadeRequired": true
    },
    {
        "id": "693a96eef172b513dd2d2747",
        "maxId": 6965,
        "benCatName": "Abortion",
        "cocSeries": 2024,
        "state": "FL",
        "standard": "Advantage+",
        "appliesTo": null,
        "crossApplies": null,
        "maxType": null,
        "maxValue": null,
        "freqType": null,
        "freqValue": null,
        "status": "Active",
        "visible": null,
        "subCategory": null,
        "isBulkCascadeRequired": true
    },
    {
        "id": "693bdf56d1dc923af8750019",
        "maxId": 6993,
        "benCatName": "Abortion",
        "cocSeries": 2024,
        "state": "FL",
        "standard": "Advantage+",
        "appliesTo": "Basic-Major",
        "crossApplies": "Yes",
        "maxType": "Dollar Limit",
        "maxValue": "11",
        "freqType": "Day(s)",
        "freqValue": 30,
        "status": "Active",
        "visible": "Yes",
        "subCategory": "",
        "isBulkCascadeRequired": true
    }
]
                                        <div>
                                            <div class="accordion w-100" id="maxAccordion" style="display: none;">
                                                <c:set var="prevKey" value="" />
                                                <c:forEach var="maximumData" items="${maxManagementSearchResponse}"
                                                    varStatus="loop">
                                                    <c:set var="currentKey"
                                                        value="${maximumData.benCatName}_${maximumData.cocSeries}_${maximumData.state}_${maximumData.standard}" />
                                                    <c:if test="${currentKey ne prevKey}">
                                                        <c:set var="subCount" value="0" />
                                                        <c:forEach var="tmp" items="${maxManagementSearchResponse}">
                                                            <c:if
                                                                test="${tmp.benCatName == maximumData.benCatName && tmp.cocSeries == maximumData.cocSeries && tmp.state == maximumData.state && tmp.standard == maximumData.standard}">
                                                                <c:set var="subCount" value="${subCount + 1}" />
                                                            </c:if>
                                                        </c:forEach>
                                                        <c:if test="${prevKey != ''}">
                                                            </tbody>
                                                            </table>
                                            </div>
                                        </div>
                                    </div>
                        </div>
                        </c:if>
                        <div class="accordion-item w-100 bt-1">
                            <h2 class="accordion-header" id="heading${loop.index}">
                                <div class="d-flex align-items-center w-100">
                                    <input type="checkbox" class="form-check-input me-2" id="selectRowChk_${loop.index}"
                                        name="selectedRows" value="${maximumData.maxId}"
                                        onclick="toggleSelectRow(${loop.index});">
                                    <div class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                                        data-bs-target="#collapse${loop.index}" aria-expanded="false"
                                        aria-controls="collapse${loop.index}">
                                        <div class="d-flex w-100 justify-content-between align-items-center selectable-accordion m-2"
                                            id="accordionRow_${loop.index}">
                                            <div class="d-flex align-items-center gap-2">
                                                <strong>${maximumData.benCatName} (${subCount})</strong>
                                                <small class="text-muted"> - ${maximumData.cocSeries} -
                                                    ${maximumData.state} - ${maximumData.standard}</small>
                                            </div>
                                            <div></div>
                                        </div>
                                    </div>
                                </div>
                            </h2>
                            <div id="collapse${loop.index}" class="accordion-collapse collapse"
                                aria-labelledby="heading${loop.index}">
                                <div class="accordion-body">
                                    <div class="d-flex gap-2 mb-2">
                                        <button class="btn btn-outline-danger btn-sm" title="Delete Parent"
                                            ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" : "" } onclick="deleteParentMaximum('${maximumData.benCatName}', '${maximumData.cocSeries}', '${maximumData.state}', '${maximumData.standard}')">
                                            <i class="fas fa-trash"></i> Delete Parent
                                        </button>
                                        <button class="btn btn-outline-primary btn-sm" title="Copy Parent & Children">
                                            <i class="fas fa-copy"></i> Copy Parent &amp; Children
                                        </button>
                                        <button class="btn btn-outline-success btn-sm" title="Add Child Maximum"
                                            id="addChildMaximum_${loop.index}" data-bs-toggle="modal"
                                            data-bs-target="#editVisitLimitModal"
                                            ${pageContext.session.getAttribute('ifpRoleId')==10 ? "disabled" :
                                            (pageContext.session.getAttribute('ifpRoleId')==8 ||
                                            pageContext.session.getAttribute('ifpRoleId')==9 ||
                                            pageContext.session.getAttribute('roleId')==4 ?"":"disabled")}
                                            onclick="openChildMaximumModal('${maximumData.maxId}', '${maximumData.benCatName}', '${maximumData.cocSeries}', '${maximumData.state}', '${maximumData.standard}');">
                                            <i class="far fa-plus" style="font-size: 20px;"></i> Add Child Maximum
                                        </button>
                                    </div>
                                    <input type="hidden" name="benefitCategoryName"
                                        id="benefitCategoryName_${loop.index}" value="${maximumData.benCatName}">
                                    <input type="hidden" name="row_${loop.index}" id="row_${loop.index}" value="0">
                                    <input type="hidden" name="rescoc" id="rescoc_${loop.index}"
                                        value="${maximumData.cocSeries}">
                                    <input type="hidden" name="resstateName" id="resstateName_${loop.index}"
                                        value="${maximumData.state}">
                                    <input type="hidden" name="resstandard" id="resstandard_${loop.index}"
                                        value="${maximumData.standard}">
                                    <div class="table-responsive">
                                        <table class="table table-hover table-striped mb-0" id="newmaxtbl">
                                            <thead>
                                                <tr>
                                                    <th scope="col">Sub Category</th>
                                                    <th scope="col">Visible</th>
                                                    <th scope="col">Applies To</th>
                                                    <th scope="col">Cross Applies</th>
                                                    <th scope="col">Max Type</th>
                                                    <th scope="col">Max Value</th>
                                                    <th scope="col">Freq. Type</th>
                                                    <th scope="col">Freq. Value</th>
                                                    <th scope="col">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                </c:if>
                                                <tr>
                                                    <td>
                                                        ${maximumData.subCategory}
                                                        <input type="hidden" name="subCategoryName_${loop.index}"
                                                            id="subCategoryName_${loop.index}"
                                                            value="${maximumData.subCategory}" />
                                                    </td>
                                                    <td>
                                                        <c:choose>
                                                            <c:when test="${maximumData.visible == 'Yes'}">
                                                                <i class="fas fa-check-circle text-success" title="Visible"></i>
                                                            </c:when>
                                                            <c:when test="${not empty maximumData.visible && maximumData.visible == 'No'}">
                                                                <i class="fas fa-times-circle text-danger" title="Not visible"></i>
                                                            </c:when>
                                                            <c:otherwise>
                                                            </c:otherwise>
                                                        </c:choose>
                                                        <input type="hidden" id="visible_${loop.index}" value="${maximumData.visible}">
                                                    </td>
                                                    <td>
                                                        ${maximumData.appliesTo}
                                                        <input type="hidden" name="appliesTo"
                                                            id="appliesTo_${loop.index}"
                                                            value="${maximumData.appliesTo}">
                                                    </td>
                                                    <td>
                                                        ${maximumData.crossApplies}
                                                        <input type="hidden" name="crossApplies"
                                                            id="crossApplies_${loop.index}"
                                                            value="${maximumData.crossApplies}">
                                                    </td>
                                                    <td>
                                                        ${maximumData.maxType}
                                                        <input type="hidden" name="maxType" id="maxType_${loop.index}"
                                                            value="${maximumData.maxType}">
                                                    </td>
                                                    <td>
                                                        ${maximumData.maxValue}
                                                        <input type="hidden" name="maxValue" id="maxValue_${loop.index}"
                                                            value="${maximumData.maxValue}">
                                                    </td>
                                                    <td>
                                                        ${maximumData.freqType}
                                                        <input type="hidden" name="freqType" id="freqType_${loop.index}"
                                                            value="${maximumData.freqType}">
                                                    </td>
                                                    <td>
                                                        ${maximumData.freqValue}
                                                        <input type="hidden" name="freqValue"
                                                            id="freqValue_${loop.index}"
                                                            value="${maximumData.freqValue}">
                                                    </td>
                                                    <td>
                                                        <div class="btn-group btn-group-sm" role="group">
                                                            <div class="btn-group">
                                                                <button class="btn btn-outline-primary"
                                                                    data-toggle="tooltip" data-placement="bottom"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    || pageContext.session.getAttribute('ifpRoleId')==8
                                                                    || pageContext.session.getAttribute('ifpRoleId')==9
                                                                    || pageContext.session.getAttribute('roleId')==4
                                                                    ?"":"disabled"} title="Edit" data-bs-toggle="modal"
                                                                    data-bs-target="#editVisitLimitModal"
                                                                    data-value="${maximumData.benCatName}^${maximumData.appliesTo}^${maximumData.crossApplies}^${maximumData.maxType}^${maximumData.maxValue}^${maximumData.freqType}^${maximumData.freqValue}^${maximumData.maxId}^${empty maximumData.subCategory ? '' : maximumData.subCategory}^${maximumData.visible}"
                                                                    id="editMaximum"
                                                                    onclick="getMaxID(${maximumData.maxId})">
                                                                    <i class="fas fa-edit"></i>
                                                                </button>
                                                                <input type="hidden"
                                                                    id="editMaximum_${maximumData.maxId}"
                                                                    data-value="${maximumData.benCatName}^${maximumData.appliesTo}^${maximumData.crossApplies}^${maximumData.maxType}^${maximumData.maxValue}^${maximumData.freqType}^${maximumData.freqValue}^${maximumData.maxId}^${empty maximumData.subCategory ? '' : maximumData.subCategory}^${maximumData.visible}">
                                                                <button class="btn btn-outline-danger"
                                                                    data-toggle="tooltip" data-placement="bottom"
                                                                    ${pageContext.session.getAttribute('ifpRoleId')==10
                                                                    ? "disabled" :
                                                                    (pageContext.session.getAttribute('ifpRoleId')==8 ||
                                                                    pageContext.session.getAttribute('ifpRoleId')==9 ||
                                                                    pageContext.session.getAttribute('roleId')==4
                                                                    ?"":"disabled")} title="Deactivate"
                                                                    data-bs-toggle="modal" id="deleteMaximum"
                                                                    onclick="deleteMaximum(${maximumData.maxId})">
                                                                    <i class="fas fa-trash"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                                <c:set var="prevKey" value="${currentKey}" />
                                                </c:forEach>
                                                <c:if test="${prevKey != ''}">
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        </c:if>
                        <c:if test="${ empty maxManagementSearchResponse || maxManagementSearchResponse.size() == 0}">
                            <div class="p-3">
                                <p>No maximums configured. Please add a new maximum to begin or perform another search.
                                </p>
                            </div>
                        </c:if>
                        </div>
                        </div>
